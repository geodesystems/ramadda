<types>
  <type name="type_geo_borehole_images"  description="Geo Image Collection"
      metadata="geo_core_annotation,geo_core_legend"
      handler="org.ramadda.repository.type.ExtensibleGroupTypeHandler"  
      childtypes="type_borehole_coreimage"
      >
    <property name="icon" value="/media/album.png"/>
    <property name="form.area.show" value="false"/>
    <property name="date.nullok" value="true"/>
    <property name="form.resource.show" value="false"/>
    <property name="form.time.show" value="false"/>    
    <column name="show_labels" type="boolean" group="Display Settings"
	    label="Show Labels"  showinhtml="false" default="true"/>
    <column name="other_entries" type="string" size="4000"  rows="5"
	    columns="80"
	    label="Other Image Collections"
	    showinhtml="false"
	    help="One entry ID per line"/>

    <column name="displays" type="string" size="4000"  rows="5"
	    columns="80"
	    label="Chart Displays"  showinhtml="false" help="One entry per line. Format:&lt;br&gt;entryid,field1:value1,...,fieldN:valueN&lt;br&gt;e.g.:&lt;br&gt;entryid,fields:gamma,indexField:depth"/>
    
    <column name="visualizer_data" type="clob" label="Visualizer Data"
	    showinhtml="false"
            candisplay="false" editable="false"/>
<wiki><![CDATA[
+section title={{name}}
:navtop
{{description wikify=true}}
{{core_visualizer showLabels="${property:show_labels}"
displayEntries="${property:displays}"
}}

:heading Table
{{table showDate=false}} 
-section
]]></wiki>


</type>

<type name="type_borehole_image"   description="Borehole Image"
      handler="org.ramadda.geodata.geo.BoreholeBaseTypeHandler">      
  <property name="icon" value="/geo/drilling-rig.png"/>
  <property name="date.nullok" value="true"/>
  <property name="inheritlocationfromtype" value="type_geo_site"/>
  <property name="form.area.show" value="false"/>
  <property name="form.location.show" value="true"/>
  <column  name="hole"  label="Hole" type="enumerationplus"  cansearch="true"/>
  <column  name="tool"  label="Tool" type="enumerationplus"  cansearch="true"
	 values="file:/org/ramadda/geodata/geo/resources/tools.txt"/>
  <column  name="measurement"  label="Measurement" type="enumerationplus"  cansearch="true"
	   values="file:/org/ramadda/geodata/geo/resources/measurements.txt"/>
  <column name="annotations_json" type="clob" label="Annotations" showinhtml="false"   candisplay="false" editable="false" canlist="false"/>     

<wiki>
<![CDATA[
+section title="Borehole image: {{name}}"
:navtop 
+row
+col-8
{{group}}
{{description wikify=true}}
{{zoomify singleFile=true annotationsField="annotations_json"
useAttachmentIfNeeded=true
}}
:vspace 1em
----
:vspace 1em
:heading Information
{{information  details="true"  showTitle="false"   showResource=false}}
-col
+col-4
<table class="formtable">
{{field name="tool"  row.label="Tool:"}}
{{field name="measurement"  row.label="Measurement:"}}
</table>
+center
{{mapentry hideIfNoLocations=true width="90%" height="200px"}}
-center
-col
-row
-section
]]>
</wiki>
</type>

<type name="type_borehole_coreimage"   description="Geo Core Image" isgroup="true"
      childtypes="type_geo_corebox_breeze_xml,type_geo_corebox_json"
      pattern="(?i).*annotated-core-photo.*\.jpg"
      handler="org.ramadda.geodata.geo.CoreImageTypeHandler">      
  <action name="applyboxes"
	  label="Apply Boxes"
	  icon="fa-regular fa-images" foruser="true" category="view"/>
  <property name="icon" value="/geo/drilling-rig.png"/>
  <property name="date.nullok" value="true"/>
  <property name="inheritlocationfromtype" value="type_geo_site"/>
  <property name="form.area.show" value="false"/>
  <property name="form.location.show" value="true"/>
  <filename_metadata pattern="^([^_]+)_" metadata_type="geo_project"/>
  <filename_metadata pattern="^[^_]+_(\d\d\d\d)" column="date"/>  
  <filename_metadata pattern="^[^_]+_\d\d\d\d_([^\.]+)\." metadata_type="geo_site"/>
  <filename_metadata pattern="(?i)(B[\d+]+)\." metadata_type="geo_box_number"/>
  <column name="top_depth" type="double" label="Top Depth" showinhtml="true" doinlineedit="true"
	  suffix="meters" default="NaN"
	  htmltemplate="${value unit=meters} ${value decimals=3 showMissing=false prefix=&quot;(&quot; suffix=&quot; feet) &quot; scale=3.28084}"/>
  <column name="bottom_depth" type="double" label="Bottom Depth" showinhtml="true" doinlineedit="true"
	  suffix="meters" default="NaN"
	  htmltemplate="${value unit=meters} ${value decimals=3 showMissing=false prefix=&quot;(&quot; suffix=&quot; feet) &quot; scale=3.28084}"	  
/>
  <column name="resolution" type="double"
	  label="Resolution" default="NaN" showinhtml="true" showempty="false"/>  
  <column name="do_rotation" type="boolean" label="Do Rotation" showinhtml="true" doinlineedit="true" default="false"/>         
  <column name="annotations_json" type="clob" label="Annotations" showinhtml="false"
	  candisplay="false" editable="false" canlist="false"/>     
  <column name="show_visualizer" type="boolean" group="Display Settings"
	  label="Show Visualizer"  showinhtml="false" default="true"/>
<property name="bubble">
<![CDATA[
+center
<b>{{name link=true}}</b>
-center
+tabs
+tab Image
+center
{{image width=400px}}
-center
-tab
+tab Information
{{information showImage=false}}
-tab
-tabs
]]></property>


<wikimacro name="corevisualizer" label="Core Visualizer"
	   icon="/geo/drilling-rig.png"	   
isoutput="true" foreditmenu="false">
  <![CDATA[
+section title="Core Image: {{name}}"
{{core_visualizer}}
-section
]]></wikimacro>


<wiki>
<![CDATA[
+section title="Core Image: {{name}}"
:navtop 
{{group}}
{{description wikify=true}}
+if show_visualizer=false
{{zoomify singleFile=true annotationsField="annotations_json"
useAttachmentIfNeeded=true}}
-if
+if show_visualizer=true
+tabs
+tab Core Visualizer
{{core_visualizer}}
-tab
+tab Annotated Image
{{zoomify singleFile=true annotationsField="annotations_json"
useAttachmentIfNeeded=true}}
-tab
-tabs
-if
:vspace 1em
----
:vspace 1em
:heading Information
+row
+col-8
{{information  details="true"  showTitle="false"   showResource=false}}
-col
+col-4
{{properties  message=""  metadata.types="geo_project,geo_site,geo_box_number" oneLine="true"
includeTitle="false"  separator=""  decorate="false" inherited="true"  }} 
+center
{{mapentry hideIfNoLocations=true width="90%" height="200px"}}
-center
-col
-row

{{tabletree message="" prefix="\n----\n:heading Children Entries\n" showDate=false}}
-section
]]>
</wiki>
</type>


<type name="type_borehole_registeredcoreimage" super="type_borehole_coreimage" foruser="false"
      description="Registered Core Image">
</type>

</types>
