<!--  This gets imported by the boreholetypes.xml-->
<type name="type_borehole_xrf"  super="type_point" description="Core XRF File" 
      pattern="(?i).*core(_|-)xrf.*\.csv"
      newfields="name,resource,depth_level,xrf_current,xrf_voltage,scan_rate,_default"
      editfields="name,resource,depth_level,xrf_current,xrf_voltage,scan_rate,_default"      
      handler="org.ramadda.geodata.geo.BoreholeTypeHandler">      
  <data_dictionary><![CDATA[
  This is the description of the Core XRF data type
]]></data_dictionary>
  <header_metadata>
    <![CDATA[
xray_kv=column:xrf_voltage
xray_ma=column:xrf_current
processed_date=column:date
scan_rate_mm_s=column:scan_rate
scan_rate=column:scan_rate
depth_level=column:depth_level
instrument=metadata2:property
*=metadata2:property
    ]]>
  </header_metadata>     

  <property name="inheritlocationfromtype" value="type_geo_site"/>
  <property name="icon" value="/geo/xray.png"/>
  <property name="record.file.class" value="org.ramadda.data.point.text.CsvFile"/>
  <property name="form.date.label" value="Scan Date"/>
  <property name="form.properties.show" value="false"/>
  <property name="form.todate.show" value="false"/>
  <property name="form.url.show" value="false"/>  
  <property name="form.resource.extra.show" value="false"/>  
  <property name="form.time.show" value="false"/>  
  <property name="form.tags.show" value="false"/>
  <property name="addinitialmetadata" value="false"/>      
  <property name="borehole.fields" value="k_wt,fe_wt,ca_wt,si_wt"/>
  <column  name="hole"  label="Hole" type="enumerationplus"  cansearch="true"
	   group="XRF Metadata" initpattern="hole_?([^_]+)_"/>

  <column  name="depth_level"  label="Depth Level" type="enumerationplus" default="NA" 
	   values="NA,1 ft,10 cm, 1m" initpattern="depth_?([^_\.]+)(_|\.)"/>
  <column  name="xrf_current"  default="" label="Current" type="double" unit="mA" suffix="mA" initpattern="current_?(\d+\.?\d*)"/>
  <column  name="xrf_voltage"  default="" label="Voltage" type="double" unit="kV" suffix="kV"
	   initpattern="(?i)(\d+)kV"	   />
  <column  name="scan_rate"    default="" label="Scan Rate" type="double" suffix="cm/s" initpattern="scan_?(\d+)"/>    
  <column  name="fields_to_show"  label="Fields to show" type="string"  cansearch="false" group="Display"
	   suffix="Comma separated list of fields, e.g., k_wt,fe_wt,ca_wt,si_wt"
	   showinhtml="false"   candisplay="false" canlist="false"/>     

<property name="record.properties">
xccsvcommands1=-start,(?i)depth_tab_,-delimiter,tab&gt;space,-trimline,-unitrow,-change,0-10,-999.*,NaN
xcsvcommands2=-addheader,
</property>
<property name="bubble">
<![CDATA[
+section  title="Borehole Log: {{name}}"
{{group}}
{{display_profile showMenu=true yAxisReverse=true marginTop=25  profileMode=markers
profileMode="lines" indexField="from_m"  }}         
]]></property>

<wikimacro name="borehole_profiles" label="Borehole Profiles" tags="forchild">
   <![CDATA[{{borehole_profiles showMenu=true yAxisReverse=true marginTop=25  profileMode=markers
	    profileMode="lines" indexField="from_m"  }}]]></wikimacro>

<wiki>
<![CDATA[
+section title="Core XRF: {{name}}"
:navtop 
+row
+col-9
{{property max="10000"}}
{{group}}
{{description wikify=true}}
:heading Chart
{{group}}
{{borehole_profiles showMenu=true yAxisReverse=true marginTop=25  profileMode=markers
profileMode="lines" indexField="from_m"  }}         
-col
+col-3
{{resource  title="Download"  showIcon="true"  simple="false"  }}
<table class="formtable">
{{field name="hole"  row.label="Hole:" }}
{{field name="depth_level"  row.label="Depth:" }}
{{field name="xrf_current"  row.label="Current:" fieldSuffix="&nbsp;mA"}}
{{field name="xrf_voltage"  row.label="Voltage:" fieldSuffix="&nbsp;kV"}}
{{field name="scan_rate"  row.label="Scan Rate:"}}
</table>
:vspace 1em
<div style="max-height:450px;overflow-y:auto">
{{properties  message=""  metadata.types="!tag:internal"
headingClass="formgroupheader" layout="linear"  includeTitle="true"  separator=""  decorate="false" 
inherited="false"  }} 
</div>
+center
{{mapentry hideIfNoLocations=true width="90%" height="200px"}}
-center
-col
-row
:heading Table
{{display_table height="70vh"  maxColumns=50 maxRecords=500}} 
:vspace 1em
----
:vspace 1em
:heading Information
{{information  details="true"  showTitle="false"  }}

-section
]]>
</wiki>


</type>
