<html>
<title>CDM Data</title>
<category:Integration>
<body>
<div class="ramadda-section">
<h2>CDM Data</h2>
:navtop

:heading Grid Subset Monitor
The Grid Subset Monitor allows  a site administrator to automatically create a subset of a newly
created grid data file using RAMADDA's <a href="https://ramadda.org/repository/userguide/monitors.html">monitor facility</a>.
:p
When logged in to RAMADDA go the Admin-&gt;Monitors page and select New Grid Subset Action.
In the Search Criteria section specify what grid entries are to be matched on.
For example, if you are adding Gridded Data to a particular folder
called Models you can specify the Grid Subset Action is applied to new Gridded File entries
under the Models folder.
:p
In the Actions  section specify the target folder to add the new subsetted grid
file under and a set of subset arguments. To specify the subset arguments go to an example
of one of the source grid files and choose the Subset Grid view. Specify your subset, e.g., spatial
bounds, time range, parameters, etc. Then at the bottom of the page click on the 
<span><i class="fas fa-earth-americas"></i></span> link. This copies to your clipboard the arguments.
You can then go to your  Grid Subset Action and paste the arguments into the form field.
If you want all of the grid fields to be added and don't want to select all of them with the checkboxes
in the  Grid Subset form then add "allvars=true" to your Grid Subset Arguments.

:p
Now, if everything works whenever a new gridded file is added to RAMADDA that matches your search criteria
the subset will be applied and a new file will be created.



:heading NetCDF Point Subset Type
RAMADDA provides a NetCDF Point Subset entry type that takes as input the
URL for the Thredds Data Server (TDS) Netcdf Point Subset Service. To use this 
got to the TDS subset form, e.g.
<a href="http://thredds.ucar.edu/thredds/ncss/grib/NCEP/GFS/Global_onedeg/GFS_Global_onedeg_20190206_0600.grib2/pointDataset.html">http://thredds.ucar.edu/thredds/ncss/grib/NCEP/GFS/Global_onedeg/GFS_Global_onedeg_20190206_0600.grib2/pointDataset.html</a>,
enter  latitude/longitude values and specify csv for the format. Ignore the time range:
<p><center><img src=images/ncss1.png></center><p>
Select the fields you are interested in. 
Note: the subset service will only work with fields that are on the same vertical coordinate system. If you choose fields that have multiple vertical levels then specify the level you'd like to use.
<p><center><img src=images/ncss2.png></center><p>
At the bottom of the page copy the generated URL:
<p><center><img src=images/ncss3.png></center><p>
Now, back in RAMADDA create a NetCDF Point Subset Type entry type. All you need to do is paste the URL
into the URL field:
<p><center><img src=images/ncss4.png></center><p>
Some of the field values will be automatically converted to different units. For example, Kelvin is
converted to Celisus, Pascals are converted to Hectopascals. 
<p>
The display shows the point subset at the specified lat/lon. The map is clickable, new data for the given
lat/lon will be displayed.
<p><center><img src=images/ncss5.png width=80%></center><p>








</body>
</html>

