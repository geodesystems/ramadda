<html>
<head>
<title>Map Files</title>
  <link rel="stylesheet" type="text/css" href="../default.css" title="Style">

</head>

<body>
<div class="ramadda-documentation">
<div class="ramadda-doc-header">
<div style='padding-top:12px;margin-bottom:4px;'><a href="../toc.html#imdv/mapfiles.html"><span title="Table of contents"><i  style='font-size:16pt;'  class="fa fa-list "></i></span></a> &nbsp; <a href="../index.html">RAMADDA User Guide</a>  > <a href="index.html">Integrated Map Data Viewer (IMDV)</a> </div>
<table width=100% cellspacing=0 cellpadding=0 >
<tr valign=center><td width=25%><div class=ramadda-doc-nav-container><div class=ramadda-doc-nav><a href="introduction.html"><table><td valign=center><td><span title="Previous: IMDV Introduction"><i  style='font-size:16pt;'  class="fa fa-caret-left "></i></span></td><td>IMDV Introduction</td></tr></table></a></div></div></td>
<td width=50% align=center>
<div class="ramadda-page-title"><a href="#">Section 6.1: Map Files</a></div>
</td>
<td align=right width=25%><div class=ramadda-doc-nav-container><div class=ramadda-doc-nav><a href="images.html"><table><tr valign=center><td>IMDV Images</td><td><span title="Next: IMDV Images"><i  style='font-size:16pt;'  class="fa fa-caret-right "></i></span></td></tr></table></a> </div></div> </td>
</tr></table>
</div>

<style type="text/css">
pre {
    margin-left:15px;
}
.ramadda-lheading {
    margin-top:15px;
}
</style>

<div class="ramadda-doc-contents" style="margin-left:20px;">



:navtop

+callout-info
We are going to use an example [https://ramadda.org/repository/a/example_map_file IMDV entry]
that shows the below map.
To explore this  example 
import the  <a href=https://ramadda.org/repository/a/userguide_boulder_county_outdoors>https://ramadda.org/repository/a/userguide_boulder_county_outdoors</a> file.
-callout


:heading Adding a Map
The IMDV supports adding a number of map file formats - GeoJson, GPX, KML/KMZ and Shapefile.
To add a map file to an IMDV entry first upload the file to RAMADDA.
The IMDV entry can act as a folder so you can upload the file under the IMDV or elsewhere
in your RAMADDA.
:p
From the IMDV New menu, select "Map File". The Map Entry selector will be shown:
Navigate through your RAMADDA entry hierarchy and select the map file.
You can also drag-and-drop the map file directly onto the IMDV map.
Note: by storing the map file as a child entry of the IMDV entry then you
can export the IMDV entry and the map file will be included in the export.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/newmap.png?version=774"><img  src="images/newmap.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/newmap.png?version=774" ></a></div></div>


Once added the IMDV will zoom to the map area. 
If there are properties defined in your map file
then a Filters area  will shown. These allow you to toggle on/off the map features. 
<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/defaultmap.png?version=774"><img  src="images/defaultmap.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/defaultmap.png?version=774" ></a></div></div>



:p
We're going to go through the set of steps to create the below map display.
The configuration includes:
* Configuring the popup display 
* Changing the label of the "Own Type Name" to "Ownership"
* Only showing the Acreage and Ownership filters
* Add a "Closed" Style Group
* Color coding based on Ownership type
* Adding a label to the top of the legend
* Adding a color bar header

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/examplemap.png?version=774"><img  src="images/examplemap.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/examplemap.png?version=774" ></a></div></div>


:heading Popup Text
The Properties dialog for the map file can be 
brought up with the <i class="fas fa-cog" style="color:#ccc;"></i> link.
:p
The Popup Text can contain arbitrary HTML as well as macros 
corresponding to the properties in the map file.
Note: the source names of the source properties are cleaned 
up and lower-cased to get the property IDs
used in these settings.
:p
For example, the below image shows the Popup Text that creates the displayed
popup. The "prop_name" property is used as a header and the ownership, acquired year
and acreage properties are shown.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/mappopup.png?version=774"><img  src="images/mappopup.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/mappopup.png?version=774" ></a></div></div>


:heading Feature Flags
The Feature Flags section allows you to configure  the labels used for the map properties,
what search properties are shown, etc. Clicking on one of the links under "Add Property"
will add that flag to the list.
:p
The below Flags changes the label of the own_type_name to "Ownership". 
The filter.show=false flag hides all filters but the &lt;property&gt;.filter.show=true
flags causes those two filters to be shown.
<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/mapfileflags.png?version=774"><img  src="images/mapfileflags.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/mapfileflags.png?version=774" ></a></div></div>


The IMDV guesses as to what type of data is a property and provides an appropriate search widget.
If you want to force the search widget to be a different type you can enter:
<pre>
some_property.filter.type=enumeration
</pre>


<a name=mapstylerules></a>
:heading Style Rules
The <b>Style Rules</b> section allows you to specify how to style each individual feature based on
the feature properties.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/stylerules.png?version=774"><img  src="images/stylerules.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/stylerules.png?version=774" ></a></div></div>

With  <b>Fill Colors</b> checked the map polygons will be colored with a set of categorical colors.
The <b>Map value to fill color</b> and <b>Map value to stroke color</b> allows you to specify
a property that is mapped into a colortable. If it is a numeric property then you can also
specify a min/max range.
:p
The <b>Style Rules</b> allows you to specify specific property value tests mapped to a set of styles.
In our example we color any feature with
Ownership="County Conservation Easement" with green and Ownership="County Owned Open Space" with blue.
Mouse over the styles to see the format, e.g.: 
<pre>
  fillColor:red
  fillOpacity:0.5
  strokeColor:blue
  strokeWidth:2
  strokeDashstyle:solid|dot|dash|dashdot|longdash|longdashdot
  externalGraphic:/repository/map/marker-blue.png
</pre>

<a name=stylegroups></a>
:heading Style Groups
The <b>Style Groups</b>  section allows you to specify one or more groups and the corresponding styles
for those groups. This enables you to "paint" specific polygons in the map.
These groups will show up in the legend. Selecting a group in the legend and then selecting
a polygon in the map will add that polygon to the group.
:p
In our example we've defined a style group called "Closed" with fill color red and diagonal striping
and another style group "Wildlife" with fill color "#008000".


<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/stylegroups.png?version=774"><img  src="images/stylegroups.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/stylegroups.png?version=774" ></a></div></div>

Once the style groups are defined they will be listed in the legend. When one of the groups are selected this
enables the user to select individual features in the map to apply the style to.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/stylegroupslegend.png?version=774"><img  src="images/stylegroupslegend.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/stylegroupslegend.png?version=774" ></a></div></div>


:heading Labels
The <b>Labels</b> section allows you to specify a template (similar to the popup text) for a label
for each polygon. 

:heading Other Configuration
The top-level properties for the IMDV entry are available through the File-&gt;Properties menu item.
:p
The color legend bar at the top of the map is defined with the Header under the Header/Footer tab.
This can be arbitrary wiki text. In this case we are using the display_legend wiki tag.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/headerfooter.png?version=774"><img  src="images/headerfooter.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/headerfooter.png?version=774" ></a></div></div>

The "Explore the trails map with the below filters" top-level legend label and the
legend width are defined in the Other Properties section.


:heading Drawing a map
The IMDV allows you to draw one or more polygons, group them and then generate a GeoJSON map file
for download.
* First, create a Group using  the New  -&gt; Group menu.
* Next, draw any number of  Lines, Polylines or Freehand objects in the map
* Drag and drop the Line/Polyline/Freehand objects in the legend onto the Group

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/makemap1.png?version=774"><img  src="images/makemap1.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/makemap1.png?version=774" ></a></div></div>


Next, bring up the Settings dialog for the Group. 
Under the "Make Map" tab you can hist "Make Map File". This will generate and download  a GeoJson map file with each of the Lines as separate features
If you want to merge the Lines into one GeoJson feature, first make sure the Lines are in
the order they are to be merged. Then in the Map Map dialog select the "Merge Polygons" checkbox
and press Make Map File. Check the GeoJson map file to ensure that the Lines are in the correct order.
If not, then drag and drop the Line-s in the Legend under the Group to specify the correct order.

<div style='text-align:center;' class='ramadda-docs-image'><div><a href="images/makemap2.png?version=774"><img  src="images/makemap2.png?version=774"  onload='HtmlUtils.initScreenshot(this);this.onload=null;' style='display:none;'  alt="images/makemap2.png?version=774" ></a></div></div>


:heading Create Route
You can create a group that contains a number of markers. Then, under the Make Map section of the Settings
dialog (above) press Create Route. 







</div>
<p>

<p>&nbsp;<p>

<div class="ramadda-doc-footer">
<table width=100% cellspacing=0 cellpadding=0 >
<tr><td width=30%><div class=ramadda-doc-nav-container><div class=ramadda-doc-nav><a href="introduction.html"><table><td valign=center><td><span title="Previous: IMDV Introduction"><i  style='font-size:16pt;'  class="fa fa-caret-left "></i></span></td><td>IMDV Introduction</td></tr></table></a></div></div></td>
<td align=right width=30%><div class=ramadda-doc-nav-container><div class=ramadda-doc-nav><a href="images.html"><table><tr valign=center><td>IMDV Images</td><td><span title="Next: IMDV Images"><i  style='font-size:16pt;'  class="fa fa-caret-right "></i></span></td></tr></table></a> </div></div> </td>
</tr></table>
</div>
<p>
</div>
</body>
</html>

