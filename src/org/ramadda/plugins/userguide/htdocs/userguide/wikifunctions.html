<html>
<head>
<title>Wiki Functions</title>
  <link rel="stylesheet" type="text/css" href="./default.css" title="Style">

</head>

<body>
<div class="ramadda-documentation">
<table width=100% cellspacing=0 cellpadding=0 ><tr><td width=30%>
<a href="wikidisplay2.html"><span title="Previous: More Wiki Display Components"><i class="fa fa-caret-left "></i></span></a> <a href="notebook.html"><span title="Next: RAMADDA Notebooks"><i class="fa fa-caret-right "></i></span></a>  <a href="toc.html#wikifunctions.html"><span title="Table of contents"><i class="fa fa-list "></i></span></a>
</td>
<td width=40% align=center>
<div class="ramadda-page-title"><a href="${root}/userguide/index.html">RAMADDA User Guide</a></div>
</td>
<td width=30%>&nbsp;</td>
</tr></table>
<div class="ramadda-page-heading">Section 5.5: Wiki Functions</div>

<style type="text/css">
pre {
    margin-left:15px;
}
</style>

<div style="margin-left:20px;">





<b> Template Macros</b><br>
Use the below macros in the templates- <br>
<pre>
//In the header/footer:
${totalCount}  - total number of records
${selectedCount}  - number of filtered records

//In the pre record template -
${&lt;field name&gt;_min}
${&lt;field name&gt;_max}
${&lt;field name&gt;_total}
${&lt;field name&gt;_average}
</pre>
These are the values specified by the user in the <a href="#filters">filter widgets</a> - <br>
<pre>
${filter_&lt;field name&gt;_min} //for numeric values
${filter_&lt;field name&gt;_max}
${filter_&lt;field name&gt;} //for enumerated and text values

//If the user does not specify a text filter value then just show blank
//If the user specifies some text filter value then wrap it with the prefix/suffix
${filter_&lt;field name&gt; prefix='some text prefix' suffix='some text suffix'} 

</pre>

<b>Template Examples</b><br>

The below example (<a href="https://geodesystems.com/repository/alias/14ers">see it here</a>) 
shows Colorado 14k foot peaks data. The display uses <a href="#filters">filter fields</a>
to allow the user to filter the data. The filter_... macros in the templates 
display the values of those filter fields. The prefix/suffix attributes in the macros
allow one to show a phrase only if a text filter value is selected by the user.

<div class="userguide-image-centered"><a href="images/charts/template.png"><img  src="images/charts/template.png" width="90%" alt="images/charts/template.png" ></a></div>

The template display is specified as:
<pre>
 {{display  type="template"  displayStyle="background:rgba(0,0,0,0);"
headerTemplate="There are a total of ${selectedCount} peaks 
between ${filter_elev_min} and ${filter_elev_max} feet 
with elevation gain between ${filter_elev_gain_min} and ${filter_elev_gain_max} feet 
${filter_class prefix=' of class '} 
${filter_range prefix=' in the ' suffix=' range'}" 
filterFields="elev,elev_gain,distance,range,class" hideFilterWidget="true"
}} 
</pre>



The below display (from  <a href="https://geodesystems.com/repository/alias/mass_shootings">here</a>) 
showing mass shooting data uses two different template displays as defined here.

<a name="image2"></a><div class="userguide-image-centered"><a href="images/template2.png"><img  src="images/template2.png" width=600 alt="Template Example" ></a><br><span class="caption">Image 2: Template Example</span></div>

<pre>
{{display  type="template" 
headerTemplate="There have been a total of ${totalCount} mass shootings with ${fatalities_total} fatalities and ${injured_total} injured"}} 
{{display  type="template" 
headerTemplate="Top 3 mass shootings: &lt;br&gt;&lt;table cellpadding=5&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;Fatalities&lt;/td&gt;&lt;td&gt;Injured&lt;/td&gt;&lt;/tr&gt;" 
template="&lt;tr&gt;&lt;td&gt;${title}&lt;/td&gt;&lt;td&gt;${fatalities}&lt;/td&gt;&lt;td&gt;${injured}&lt;/td&gt;&lt;/tr&gt;"
footerTemplate="&lt;/table&gt;" 
maxNumber="3" 
sortFields=fatalities 
sortAscending=false
}} 
</pre>




<a name="derived"></a><p><div class="ramadda-help-heading">5.5.0 <a href="#derived">Derived Data</a></div> 

Derived data can be calculated by specifying a javascript function with the field ids. For example, in the 
<a href="https://geodesystems.com/repository/entry/show?entryid=e8af924a-2194-4fd0-83be-92d006837c00">election data example</a> 
one of the displays shows the turnout percentage using the following attributes:
<pre>function=&quot;total_ballots/active_voters&quot; 
functionName=&quot;turnout&quot;</pre>

The full wiki text is:
<pre>{{display  type=&quot;areachart&quot;  column=&quot;0&quot; 
layoutHere=&quot;true&quot;  showTitle=&quot;true&quot;  title=&quot;Line Chart with Function&quot;  
vAxisMinValue=&quot;0&quot; vAxisMaxValue=&quot;1.0&quot; padRight=&quot;true&quot;
function=&quot;total_ballots/active_voters&quot; functionName=&quot;turnout&quot;}}</pre>

Percentage values can be calculated with the <i>showPercent</i> attribute. This sums up the values of all of the specified fields and uses the
percent value.


<a name="scaleoffset"></a><p><div class="ramadda-help-heading">5.5.1 <a href="#scaleoffset">Scaling and offset of data</a></div> 
The data values and or displayed unit of the point data that is displayed in chart can be modified
by specifying offset and scale units. For example, one can convert Kelvin to Celsius in a display
with the following attributes:

<div style="margin:10p;"><pre>
{{display type=&quot;linechart&quot; offset1=-&quot;273.15&quot; unit=&quot;C&quot; }}
</pre></div>

There are also scale and offset2 values supported where the end value is calculated as:
<div style="margin:10p;"><pre>
value = (offset1+value)*scale + offset2
</pre></div>

You can specify values specific for a particular field using:

<div style="margin:10p;"><pre>
{{display type=&quot;linechart&quot; Temperature_surface.offset1=-&quot;273.15&quot; Temperature_surface.unit=&quot;C&quot;
}}
</pre></div>


<a name="displayProperty"></a><p><div class="ramadda-help-heading">5.5.2 <a href="#displayProperty">Setting shared properties</a></div> 
Sometimes there are a number of displays on a single page that share the same set of properties.
For example, this <a href="https://geodesystems.com/repository/entry/show?entryid=8fafafa0-0105-4f14-9c86-6a9902f186a9">page</a>
shows a number of charts of atmospheric time series data. The data itself has temperature in Kelvin and pressure in Pascals. 
However, the displays show the data in Celsius and Hectopascals. As described aboce a scale, offset and new unit 
for the displays showing temperature and pressure data can be specified. However, because there are a number of displays
that show this data one would have to specify these attributes for every display tag. However, using the <i>displayPropert</i>
tag global properties can be specified that are applicable to all displays on the page:

<div style="margin:10p;"><pre>
{{displayProperty name=&quot;Temperature_surface.offset1&quot; value=&quot;-273.15&quot;}}
{{displayProperty name=&quot;Temperature_surface.unit&quot; value=&quot;C&quot;}}
{{displayProperty name=&quot;Pressure_surface.scale&quot; value=&quot;0.01&quot;}}
{{displayProperty name=&quot;Pressure_surface.unit&quot; value=&quot;hPa&quot;}}
</pre></div>


<a name="filtering"></a><p><div class="ramadda-help-heading">5.5.3 <a href="#filtering">Filtering data</a></div> 
You can filter the data that is shown based on string pattern matching or numeric operators.
You do this with the attributes:
<pre>
patternFilterField="field id" 
filterPattern="some string"
numericFilterField="other field id" 
numericFilterValue="number" 
numericFilterOperator="&gt;|&gt;=|==|&lt;|&lt;=" 
</pre>
e.g.: below would only show data where the 1st matches the string "Texas" and the 3rd needs to be less that 5000.
<pre>
{{display  type="sankey" height="800" 
patternFilterField="#1" filterPattern="Texas"
numericFilterField="#3" numericFilterValue="5000" numericFilterOperator=">" 
}}
</pre>




</div>
<p>
<div  class="childlist" ><table  width="100%" ><tr  valign="top" ><td  width="10%"  align="right" ><span  class="childlist-level" >
5.5.0&nbsp;
</span></td><td><a  class="childlist-link"  href="wikifunctions.html#derived" >
<a href="#derived">Derived Data</a>
</a><br></td></tr><tr  valign="top" ><td  width="10%"  align="right" ><span  class="childlist-level" >
5.5.1&nbsp;
</span></td><td><a  class="childlist-link"  href="wikifunctions.html#scaleoffset" >
<a href="#scaleoffset">Scaling and offset of data</a>
</a><br></td></tr><tr  valign="top" ><td  width="10%"  align="right" ><span  class="childlist-level" >
5.5.2&nbsp;
</span></td><td><a  class="childlist-link"  href="wikifunctions.html#displayProperty" >
<a href="#displayProperty">Setting shared properties</a>
</a><br></td></tr><tr  valign="top" ><td  width="10%"  align="right" ><span  class="childlist-level" >
5.5.3&nbsp;
</span></td><td><a  class="childlist-link"  href="wikifunctions.html#filtering" >
<a href="#filtering">Filtering data</a>
</a><br></td></tr></table></div>
<p>&nbsp;<p>
<a href="wikidisplay2.html"><span title="Previous: More Wiki Display Components"><i class="fa fa-caret-left "></i></span></a> <a href="notebook.html"><span title="Next: RAMADDA Notebooks"><i class="fa fa-caret-right "></i></span></a>  <a href="toc.html#wikifunctions.html"><span title="Table of contents"><i class="fa fa-list "></i></span></a>
<p>
</div>
</body>
</html>

