<link rel='stylesheet' type='text/css' href='/repository/userguide.css'>


<%nochildlist%>





:h2 Extract, Transform, Load CSV Files


RAMADDA provides an interactive facility to transform CSV, JSON, XML or HTML files and create structured
point data files and databases.
<p>
To start, upload the CSV/JSON/XML/HTML file into RAMADDA. Go to the  <code class="menu">Main Menu-&gt;View-&gt;Convert Data</code> menu to see the conversion interface below.  A pipeline of commands are defined for manipulating the rows and columns of the source file. 
These commands can be on the same line or on multiple lines. If on multiple lines then the intermediate processing results of each line of commands is available. Prefix a line with "#" to comment out the line.
<a name="image1"></a><div class="userguide-image-centered"><a href="images/etl.png"><img  src="images/etl.png" width=90% alt="CSV Conversion Interface" ></a><br><span class="caption">Image 1: CSV Conversion Interface</span></div>

<ul>
  <li> The <span><i class="fa fa-plus"></i></span> button allows you to add a new command. Once added you can edit the command in place or right click on the command to bring up the command editor dialog (see below).
  <li> The <span><i class="fa fa-file"></i></span> button allows you to insert a reference to another file in RAMADDA for those c
ommands (e.g., join) that require other files.
  <li> The <span><i class="fa fa-sliders-h"></i></span> button allows you to specify settings -
    <ul>
    </ul>
  <li> The <span><i class="fa fa-question-circle"></i></span> button displays help.
  <li> The Header, Table, Records, etc., buttons runs the commands and produces different output.
The Save checkbox saves the command text when you run the commands so you can return to it later. 
The Do Commands checkbox applies the commands when you press one of the run buttons.
</ul>


Many of the commands below take a columns specification. This takes the form of:
<pre>
&quot;colA,colB,colC-colD,colE,...&quot;
e.g.:
&quot;0,1,2,7-10,12&quot;
</pre>



:h2 Extracting HTML

The conversion service supports extracting data from an HTML table in a HTML page. Save the HTML page and upload to RAMADDA as a CSV File entry type. Then go to the conversion page.  The first command to enter is the -html command:
<pre>
-html &quot;name value arguments&quot;
</pre>


The name/value arguments include:
<pre>
-html &quot;skip &lt;how many tables in the HTML file to skip&gt;&quot;
-html &quot;removePattern &lt;regexp pattern to remove&gt;  removePattern2 &lt;another pattern to remove&gt;&quot;
</pre>

Because there are many levels of parsing of escape characters if 
you need to remove text that contains special regular expression characters - [,],(,) and . - use the special tags:
_leftbracket_, _rightbracket_, _leftparent_, _rightparen_, _dot_, e.g.:

<pre>
-html &quot;removePattern _leftbracket_.*?_rightbracket_ &quot;
</pre>



:h2 Slice and Dice

:h3  Select columns
Usage:<pre>-columns  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Only include the given columns<p>
:h3  Deselect columns
Usage:<pre>-notcolumns  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Don't include the given columns<p>
:h3  Delete columns
Usage:<pre>-delete  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Remove the columns<p>
:h3  Cut rows
Usage:<pre>-cut  &lt;rows(One or more rows. -1 to the end. e.g., 0-3,5,10,-1) &gt;</pre><p>
:h3  Include rows
Usage:<pre>-include  &lt;rows(one or more rows, -1 to the end) &gt;</pre>Only include specified rows<p>
:h3  Skip
Usage:<pre>-skip  &lt;rows(How many rows to skip) &gt;</pre>Skip number of rows<p>
:h3  Copy column
Usage:<pre>-copy  &lt;column&gt; &lt;name&gt;</pre><p>
:h3  Insert column
Usage:<pre>-insert  &lt;column(Column to insert after) &gt; &lt;values(Single value or comma separated for multiple rows) &gt;</pre>Insert new column values<p>
:h3  Concat
Usage:<pre>-concat  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;delimiter&gt;</pre>Create a new column from the given columns<p>
:h3  Split
Usage:<pre>-split  &lt;column&gt; &lt;delimiter(What to split on) &gt; &lt;names(Comma separated new column names) &gt;</pre>Split the column<p>
:h3  Splat
Usage:<pre>-splat  &lt;key col&gt; &lt;column&gt; &lt;delimiter&gt; &lt;name(new column name) &gt;</pre>Create a new column from the values in the given column<p>
:h3  Shift columns
Usage:<pre>-shift  &lt;rows(Rows to apply to) &gt; &lt;column(Column to start at) &gt; &lt;count&gt;</pre>Shift columns over by count for given rows<p>
:h3  Add cell
Usage:<pre>-addcell  &lt;row&gt; &lt;column&gt; &lt;value&gt;</pre>Add a new cell at row/column<p>
:h3  Delete cell
Usage:<pre>-deletecell  &lt;row&gt; &lt;column&gt;</pre>Delete cell at row/column<p>
:h3  Merge rows
Usage:<pre>-mergerows  &lt;rows(2 or more rows) &gt; &lt;delimiter&gt; &lt;close&gt;</pre><p>
:h3  Rotate
Usage:<pre>-rotate </pre>Rotate the data<p>
:h3  Flip
Usage:<pre>-flip </pre>Reverse the order of the rows except the header<p>
:h3  Unfurl
Usage:<pre>-unfurl  &lt;column(column to get new column header#) &gt; &lt;value columns(Columns to get values from) &gt; &lt;unique column(The unique value, e.g. date) &gt; &lt;other columns(Other columns to include) &gt;</pre>Make columns from data values<p>
:h3  Furl
Usage:<pre>-furl  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;header label&gt; &lt;value label&gt;</pre>Use values in header to make new row<p>
:h3  Explode
Usage:<pre>-explode  &lt;column&gt;</pre>Make separate files based on value of column<p>
:h3  Join
Usage:<pre>-join  &lt;key columns&gt; &lt;value_columns(value columns) &gt; &lt;file(File to join with) &gt; &lt;source_columns(source key columns) &gt;</pre>Join the 2 files together<p>
:h2 Filter

:h3  Start
Usage:<pre>-start  &lt;start pattern&gt;</pre>Start at pattern in source file<p>
:h3  Stop
Usage:<pre>-stop  &lt;stop pattern&gt;</pre>End at pattern in source file<p>
:h3  Rawlines
Usage:<pre>-rawlines  &lt;lines(How many lines to pass through unprocesed) &gt;</pre><p>
:h3  Min
Usage:<pre>-min  &lt;min # columns&gt;</pre>Only pass thorough lines that have at least this number of columns<p>
:h3  Max
Usage:<pre>-max  &lt;max # columns&gt;</pre>Only pass through lines that have no more than this number of columns<p>
:h3  Pattern
Usage:<pre>-pattern  &lt;column&gt; &lt;pattern&gt;</pre>Pass through rows that match the pattern<p>
:h3  Notpattern
Usage:<pre>-notpattern  &lt;column&gt; &lt;pattern&gt;</pre>Pass through rows that don't match the pattern<p>
:h3  Unique
Usage:<pre>-unique  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Pass through unique values<p>
:h3  Duplicate values
Usage:<pre>-dups  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Pass through duplicate values<p>
:h3  Max value
Usage:<pre>-maxvalue  &lt;key column&gt; &lt;value column&gt;</pre><p>
:h3  Equals
Usage:<pre>-eq  &lt;column&gt; &lt;value&gt;</pre>Extract rows that pass the expression<p>
:h3  Greater than
Usage:<pre>-gt  &lt;column&gt; &lt;value&gt;</pre>Extract rows that pass the expression<p>
:h3  Greater than/equals
Usage:<pre>-ge  &lt;column&gt; &lt;value&gt;</pre>Extract rows that pass the expression<p>
:h3  Less than
Usage:<pre>-lt  &lt;column&gt; &lt;value&gt;</pre>Extract rows that pass the expression<p>
:h3  Less than/equals
Usage:<pre>-le  &lt;column&gt; &lt;value&gt;</pre>Extract rows that pass the expression<p>
:h3  Before date
Usage:<pre>-before  &lt;column&gt; &lt;format&gt; &lt;date&gt; &lt;format2&gt;</pre><p>
:h3  After date
Usage:<pre>-after  &lt;column&gt; &lt;format&gt; &lt;date&gt; &lt;format2&gt;</pre><p>
:h3  Max unique values
Usage:<pre>-countvalue  &lt;column&gt; &lt;count&gt;</pre>No more than count unique values<p>
:h3  Decimate
Usage:<pre>-decimate  &lt;rows(# of start rows to include) &gt; &lt;skip(skip factor) &gt;</pre>only include every &lt;skip factor&gt; row<p>
:h3  Skipline
Usage:<pre>-skipline  &lt;pattern&gt;</pre>Skip any line that matches the pattern<p>
:h2 Change Values

:h3  Change
Usage:<pre>-change  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;pattern&gt; &lt;substitution string(use $1, $2, etc for pattern (...) matches) &gt;</pre>Change columns<p>
:h3  Changerow
Usage:<pre>-changerow  &lt;rows(Row indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;pattern&gt; &lt;substitution string&gt;</pre>Change the values in the row/cols<p>
:h3  Set
Usage:<pre>-set  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;rows(Row indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;value&gt;</pre>Write the value into the cells<p>
:h3  Macro
Usage:<pre>-macro  &lt;pattern&gt; &lt;template&gt; &lt;column label&gt;</pre>Look for the pattern in the header and apply the template to make a new column, template: '{1} {2} ...', use 'none' for column name for no header<p>
:h3  Setcol
Usage:<pre>-setcol  &lt;column(match col #) &gt; &lt;pattern&gt; &lt;write column&gt; &lt;value&gt;</pre>Write the value into the write col for rows that match the pattern<p>
:h3  Priorprefix
Usage:<pre>-priorprefix  &lt;column&gt; &lt;pattern&gt; &lt;delimiter&gt;</pre>Append prefix from the previous element to rows that match pattern<p>
:h3  Letter
Usage:<pre>-letter </pre>Add 'A','B', ... as column<p>
:h3  Case
Usage:<pre>-case  &lt;type&gt; &lt;column&gt;</pre>Change case of column<p>
:h3  Width
Usage:<pre>-width  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;size&gt;</pre>Limit the string size of the columns<p>
:h3  Prepend
Usage:<pre>-prepend  &lt;text&gt;</pre>Add the text to the beginning of the file. use _nl_ to insert newlines<p>
:h3  Pad
Usage:<pre>-pad  &lt;count&gt; &lt;pad string&gt;</pre>Add or remove columns to achieve the count<p>
:h3  Prefix
Usage:<pre>-prefix  &lt;column&gt; &lt;prefix&gt;</pre>Add prefix to column<p>
:h3  Suffix
Usage:<pre>-suffix  &lt;column&gt; &lt;suffix&gt;</pre>Add suffix to column<p>
:h3  Js
Usage:<pre>-js  &lt;javascript&gt;</pre>Define Javascript to use later<p>
:h3  Func
Usage:<pre>-func  &lt;names(New column names) &gt; &lt;javascript(javascript expression) &gt;</pre>Apply the function. Use column names or _col#<p>
:h3  Endswith
Usage:<pre>-endswith  &lt;column&gt; &lt;string&gt;</pre>Ensure that each column ends with the string<p>
:h3  Trim
Usage:<pre>-trim  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Trim the string values<p>
:h3  Convert date
Usage:<pre>-convertdate  &lt;column&gt; &lt;sourceformat(Source format) &gt; &lt;destformat(Target format) &gt;</pre><p>
:h3  Extract date
Usage:<pre>-extractdate  &lt;date column&gt; &lt;format(Date format) &gt; &lt;timezone&gt; &lt;what(What to extract) &gt;</pre><p>
:h3  Format date
Usage:<pre>-formatdate  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;intial date format&gt; &lt;target date format&gt;</pre><p>
:h3  Truncate
Usage:<pre>-truncate  &lt;column&gt; &lt;max length&gt; &lt;suffix&gt;</pre><p>
:h3  Extract
Usage:<pre>-extract  &lt;column&gt; &lt;pattern&gt; &lt;replace with(use 'none' for no replacement) &gt; &lt;new column name&gt;</pre>Extract text from column and make a new column<p>
:h3  Map
Usage:<pre>-map  &lt;column&gt; &lt;new columns name&gt; &lt;value newvalue ...&gt;</pre>Change values in column to new values<p>
:h3  Combine
Usage:<pre>-combine  &lt;column&gt; &lt;delimiter&gt; &lt;new column name&gt;</pre>Combine columns with the delimiter. deleting columns<p>
:h3  Combine in place
Usage:<pre>-combineinplace  &lt;column&gt; &lt;delimiter&gt; &lt;new column name&gt;</pre>Combine columns with the delimiter<p>
:h3  Format
Usage:<pre>-format  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;format(Decimal format  e.g. '##0.00') &gt;</pre><p>
:h3  Denormalize
Usage:<pre>-denormalize  &lt;file(From csv file) &gt; &lt;from id idx&gt; &lt;from value idx&gt; &lt;to idx&gt; &lt;new col name&gt; &lt;mode replace add&gt;</pre>Read the id,value from file and substitute the value in the dest file col idx<p>
:h3  Break
Usage:<pre>-break  &lt;label1&gt; &lt;label2&gt; &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Break apart column values and make new rows<p>
:h3  Desc
Usage:<pre>-desc  &lt;column&gt; &lt;suffix&gt;</pre>Add a description from wikipedia<p>
:h3  Image
Usage:<pre>-image  &lt;column&gt; &lt;suffix&gt;</pre>Search for an image<p>
:h3  Gender
Usage:<pre>-gender  &lt;column&gt;</pre>Figure out the gender of the name in the column<p>
:h2 Numeric

:h3  Scale
Usage:<pre>-scale  &lt;column&gt; &lt;delta1&gt; &lt;scale&gt; &lt;delta2&gt;</pre>Set value={value+delta1}*scale+delta2<p>
:h3  Row average
Usage:<pre>-rowaverage  &lt;&gt;</pre>Average the row values<p>
:h3  Generate
Usage:<pre>-generate  &lt;label&gt; &lt;start&gt; &lt;step&gt;</pre>Add row values<p>
:h3  Decimals
Usage:<pre>-decimals  &lt;column&gt; &lt;how many decimals to round to&gt;</pre><p>
:h3  Operator
Usage:<pre>-operator  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;new col name&gt; &lt;operator +,-,*,/&gt;</pre>Apply the operator to the given columns and create new one<p>
:h3  Round
Usage:<pre>-round  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>round the values<p>
:h3  Sum
Usage:<pre>-sum  &lt;key columns&gt; &lt;value columns&gt; &lt;carry over columns&gt;</pre>Sum values keying on name column value. If no value columns specified then do a count<p>
:h3  Percent
Usage:<pre>-percent  &lt;columns to add&gt;</pre><p>
:h3  Increase
Usage:<pre>-increase  &lt;column&gt; &lt;how far back&gt;</pre>Calculate percent increase<p>
:h3  Average
Usage:<pre>-average  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;period&gt; &lt;label&gt;</pre>Calculate a moving average<p>
:h2 Geocode

:h3  Geocode
Usage:<pre>-geocode  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;prefix(e.g., state: or county:) &gt; &lt;suffix&gt;</pre><p>
:h3  Geocode address for DB
Usage:<pre>-geocodeaddressdb  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;prefix&gt; &lt;suffix> &gt;</pre><p>
:h3  Geocode with file
Usage:<pre>-geocodejoin  &lt;column&gt; &lt;csv file(File to get lat/lon from) &gt; &lt;name idx&gt; &lt;lat idx&gt; &lt;lon idx&gt;</pre>Geocode with file<p>
:h3  Mercator
Usage:<pre>-mercator  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt;</pre>Convert x/y to lon/lat<p>
:h3  Population
Usage:<pre>-population  &lt;columns(Column indices, one per line.<br>Can include ranges, e.g. 0-5) &gt; &lt;prefix(e.g., state: or county:) &gt; &lt;suffix&gt;</pre>Add in population from address<p>
:h2 Other Commands

:h3  Sort
Usage:<pre>-sort  &lt;column(Column to sort on) &gt;</pre><p>
:h3  Count
Usage:<pre>-count </pre>Show count<p>
:h3  Maxrows
Usage:<pre>-maxrows  &lt;Max rows to print&gt;</pre><p>
:h3  Change line
Usage:<pre>-changeline  &lt;from&gt; &lt;to&gt;</pre>Change the line<p>
:h3  Change input
Usage:<pre>-changeraw  &lt;from&gt; &lt;to&gt;</pre>Change input text<p>
:h3  Strict
Usage:<pre>-strict </pre>Be strict on columns. any rows that are not the size of the other rows are dropped<p>
:h3  Flag
Usage:<pre>-flag </pre>Be strict on columns. any rows that are not the size of the other rows are shown<p>
:h3  Verify
Usage:<pre>-verify  &lt;# columns&gt;</pre>Throw error if a row has a different number of columns<p>
:h3  Comment
Usage:<pre>-comment  &lt;string&gt;</pre><p>
:h3  Verify
Usage:<pre>-verify </pre>Verify that all of the rows have the same # of columns<p>
:h2 Input

:h3  Delimiter
Usage:<pre>-delimiter  &lt;delimiter(Use 'space' for space, 'tab' for tab) &gt;</pre>Specify a delimiter<p>
:h3  Tab
Usage:<pre>-tab </pre>Use tabs<p>
:h3  Widths
Usage:<pre>-widths  &lt;widths(w1,w2,...,wN) &gt;</pre>Columns are fixed widths<p>
:h3  Header
Usage:<pre>-header  &lt;header(Column names) &gt;</pre>Raw header<p>
:h3  Html
Usage:<pre>-html  &lt;skip(Number of tables to skip) &gt; &lt;pattern(Pattern to skip to) &gt; &lt;properties(Other attributes - <br>&nbsp;&nbsp;removeEntity false removePattern pattern) &gt;</pre>Parse the table in the input html file<p>
:h3  Extract from html
Usage:<pre>-htmlpattern  &lt;columns(Column names) &gt; &lt;startPattern&gt; &lt;endPattern&gt; &lt;pattern(Row pattern. Use (...) to match columns) &gt;</pre>Parse the input html file<p>
:h3  Json
Usage:<pre>-json  &lt;arrayPath(Path to the array e.g., obj1.arr[2].obj2) &gt; &lt;objectPaths(One or more paths to the objects e.g. geometry,features) &gt;</pre>Parse the input as json<p>
:h3  Xml
Usage:<pre>-xml  &lt;path(Path to the elements) &gt;</pre>Parse the input as xml<p>
:h3  Text
Usage:<pre>-text  &lt;comma separated header&gt; &lt;chunk pattern&gt; &lt;token pattern&gt;</pre>Extract rows from the text<p>
:h3  Tokenize
Usage:<pre>-tokenize  &lt;header(header1,header2...) &gt; &lt;pattern&gt;</pre>Tokenize the input from the pattern<p>
:h3  Prune
Usage:<pre>-prune  &lt;bytes(Number of leading bytes to remove) &gt;</pre>Prune out the first N bytes<p>
:h2 Output

:h3  Print
Usage:<pre>-print </pre>Output the rows<p>
:h3  Template
Usage:<pre>-template  &lt;prefix&gt; &lt;template(Use ${0},${1}, etc for values) &gt; &lt;delimiter(Output between rows) &gt; &lt;suffix&gt;</pre>Apply the template to make the output<p>
:h3  Raw
Usage:<pre>-raw </pre>Print the file raw<p>
:h3  Record
Usage:<pre>-record </pre>Print records<p>
:h3  Printheader
Usage:<pre>-printheader </pre>Print the first line<p>
:h3  Pointheader
Usage:<pre>-pointheader </pre>Generate the RAMADDA point properties<p>
:h3  Add header
Usage:<pre>-addheader  &lt;properties(name1 value1 ... nameN valueN) &gt;</pre>Add the RAMADDA point properties<p>
:h3  Db
Usage:<pre>-db  &lt;props(Name value pairs:
		table.id <new id> table.name <new name> table.cansearch <true|false> table.canlist <true|false> table.icon <icon, e.g., /db/database.png>
		<column name>.id <new id for column> <column name>.label <new label>
		<column name>.type <string|enumeration|double|int|date>
		<column name>.format <yyyy MM dd HH mm ss format for dates>
		<column name>.canlist <true|false> <column name>.cansearch <true|false>
		install <true|false install the new db table>
		nukedb <true|false careful! this deletes any prior created dbs) &gt;</pre>Generate the RAMADDA db xml from the header<p>
:h3  Run
Usage:<pre>-run  &lt;Name of process directory&gt;</pre><p>
:h3  Cat
Usage:<pre>-cat  &lt;*.csv&gt;</pre>One or more csv files<p>

</body>



