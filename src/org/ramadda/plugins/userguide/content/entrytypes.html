[ht::head {Defining New Entry Types}]
:navtop

:heading Entry Types
RAMADDA recognizes any plugin file that ends with types.xml as an entry type definition file.
Here is an <a href="${root}/userguide/examples/exampletypes.xml.txt">exampletypes.xml</a> file and
there are numerous examples in the source code @ github,
e.g. <a href=https://github.com/geodesystems/ramadda/tree/master/src/org/ramadda/geodata/point/resources>https://github.com/geodesystems/ramadda/tree/master/src/org/ramadda/geodata/point/resources</a>
:p
You can use the above xml file as a plugin, copying it into your RAMADDA home/plugins directory.
But, if you wanted to include html or other resources you should create a directory
structure like below and zip the directory and copy the .zip file to the plugins directory.
<pre>
someplugin
      exampletypes.xml
      htdocs
          myplugin
               example.png
</pre>

For example, this would allow you to reference the example.png image as an icon for the entry type with
the property:
<pre>
&lt;property name="icon" value="/myplugin/example.png"/&gt;>
</pre>




:heading Column Types
Each entry can have any number of column attributes. Each column (see in the example above) has a name, label, type, etc:

<ul>
<li> <i> string</i> -  Use size="..." to specify the column size
<li> <i> enumeration</i>  - See below to specify values
<li> <i> enumerationplus</i>  - Just like enumeration but allows use to enter new text values
<li> <i> list</i>  - A big string internally but shows a list of newline separated text values to the user
<li> <i> password</i>  - A string but is shown in a password field
<li> <i> clob</i>  - A big character large object
<li> <i> int</i>  - Integer
<li> <i> double</i>  - floating point number
<li> <i> percentage</i> - floating point number shows as percentage
<li> <i> boolean</i>  
<li> <i> date</i>  - Just a date
<li> <i> datetime</i>  - A date and a time
<li> <i> email</i>  - Shows as an email address
<li> <i> url</i>  - Shows as a URL
<li> <i> latlonbbox</i> - spatial bounds
<li> <i> latlon</i>  - A single point
</ul>

For enumeration or  enumerationplus types you can specify a set of enumeration values. 
<pre>
  &lt;column name="fruit" label="Fruit" type="enumeration" values="apple,banana,orange" cansearch="true" /&gt;
</pre>

:heading Wiki Template
An entry type can have a wiki tag that defines the wiki text template for the entry.
The example file above has an example of this wiki text, e.g.:
+pre
&lt;wiki&gt;
&lt;!\[CDATA\[
+section title={{name}}
:navtop
{{description wikify=true}}
:heading Charts
{{group}}
{{display type=linechart showMenu=true fields=discharge}}
{{display type=linechart showMenu=true fields=gauge_height}}
:vspace 0.5em
:heading Table
{{display_download}}
{{display_table}}
:vspace 1em
----
:heading Information
+row
+col-md-6
{{information  details="true"  showTitle="false"  }} 
-col
+col-6
{{map}}
-col
-row
-section
\]\]&gt;
&lt;/wiki&gt;
-pre



:heading Create Entry Type Form
All entries have a Create Entry Type form available. From the Entry popup menu
select "Create Entry Type". Once defined you can hit Install Type to generate the entry
type definition and install it into memory. This allows you to create an entry of this
type to try it out. However, this does not permanently install the entry type definition.
To do that press Download Type. This will generate a a plugin file
(e.g., type_archive_seed_specimen.xml) which needs to be copied into the RAMADDA plugins directory
or incorporated into a built plugin file.
:p
For example, let's say you have 100 CSV files of the same format and want to create a new entry type.
Upload one of the CSV files to your RAMADDA. You can use the <a href=seesv.html>SeeSV</a>  package
to data wrangle the CSV file, cleaning up the data, adding a header, etc. You can then edit the description
of the CSV file and enter the appropriate <a href=wiki/wiki.html>wiki text</a> to define the entry type's appearance.
:p
Once satisfied, go to the Create Entry Type form and specify:


[ht::screenshot images/createtype1.png]

:heading2 Entry Type  - Basic
[ht::screenshot images/createtype_basic.png]


The Basic  section allows you to define the basic entry type information-
<ul>
<li> A type ID - this needs to start with type_, be lower case with no spaces or special characters
<li> A name of the type
<li> A "super type" - entry types in RAMADDA are hierarchical. If you want this to be point data the specify type_point. There is a link to the master list of all entry types  available.
<li> Java handler - this is the Java class that handles this type.
  If this is point data then specify "org.ramadda.data.services.PointTypeHandler".
  If it is just some normal entry but you will specify metadata columns then
  specify "org.ramadda.repository.type.GenericTypeHandler".
  Else specify "org.ramadda.repository.type.TypeHandler"
<li> You can specify an optional Super Category and Category. This is used to organize the big list of types.
<li> An icon. You can provide your own icon as described above or view the icons available on <a href=https://github.com/geodesystems/ramadda/tree/master/src/org/ramadda/repository/htdocs/icons>github</a>
</ul>


:heading2 Entry Type - Admin
[ht::screenshot images/createtype_admin.png]
The Admin section allows you to specify a comment which gets included in the generated type.xml
file.
:p
If the For Import is not checked then the generated will be of the form - e.g., type_archive_seed_specimen_types.xml and can be directly added as a plugin file.
:p
If For Import is checked then the  generated xml file
is of the form &lt;type_the_type.xml&gt; and will not be recognized as a plugin file.
(e.g., type_archive_seed_specimen.xml) as entry type files all end in "types.xml"
You can import the file in a file, e.g., importtypes.xml,that contains, e.g., the below.
This allows you to handle in order the entry types that inherit from other types
<pre>
&lt;types&gt;
&lt;import resource="type_archive_site.xml"/&gt;
&lt;import resource="type_archive_specimen.xml"/&gt;
&lt;/types&gt;
</pre>

:p
If the "Yes, drop the database table" is checked and your password is entered then
the whole database table is dropped and recreated from the Columns definiton.
Be careful using this as any data might be lost. This is provided because sometimes the
database data type of column definitions  has to be changed (e.g, a string to a double) and
the change isn't allowed by the database.

:heading2 Entry Type - Properties
The Properties section provides a way to specify the myriad number of entry type properties.
Examples of the available properties are listed in the right.
[ht::screenshot images/createtype_properties.png]

There are 2 sets of properties - the XML Attributes and the more general purpose Properties.
The XML attributes have to be of the form:
<pre>
attribute_name="value"
</pre>


:heading2 Entry Type - Advanced Configuration
The Advanced Configuration section allows you to put any other XML into the generated 
types.xml file. TBD.

[ht::screenshot images/createtype_advanced.png]

:heading2 Entry Type - Columns
The Columns section allows you to define the entry type columns.
Each column consists of a column name, label, data type and any number
of extra properties. 
[ht::screenshot images/createtype_columns.png]

The column name must be a valid database column name - lowercase, no spaces, no punctuation, etc.
You can entry these directly into the form or keep them in a separate text file
for easy editing then use the Bulk Upload.
:p
The "Show properties" link popups a Column Attributes dialog that allows you to add
the many different properties that control the behavior of the Column.

[ht::screenshot images/createtype_attributes.png]


:heading2 Creating the entry type
Once specified press Download Type.
This will generate and download a types.xml file which you can install as a plugin
or import into a types.xml file.
:p
If you have any SeeSV commands specified for the entry to convert CSV data
then those are included in the generated
types.xml. If you have wiki text specified then that too is included.

</body>
