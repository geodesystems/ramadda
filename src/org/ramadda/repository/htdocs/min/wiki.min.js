function insertText(d,c){hidePopupObject();var b=HtmlUtils.getAceEditor(d);var a=GuiUtils.getDomObject(d);if(a||b){insertAtCursor(d,a.obj,c)}}function insertAtCursor(h,d,e){var c=HtmlUtils.getAceEditor(h);if(c){var g=c.getCursorPosition();c.insert(e);c.focus();return}var f=d.scrollTop;if(document.selection){d.focus();sel=document.selection.createRange();sel.text=e}else{if(d.selectionStart||d.selectionStart=="0"){var b=d.selectionStart;var a=d.selectionEnd;d.value=d.value.substring(0,b)+e+d.value.substring(a,d.value.length)}else{d.value+=e}}d.scrollTop=f}function insertTags(f,b,a,e){hidePopupObject();var d=GuiUtils.getDomObject(f);var c=HtmlUtils.getAceEditor(f);if(d||c){insertTagsInner(f,d.obj,b,a,e)}}function insertTagsInner(c,m,l,a,e){var d,g=false;l=l.replace(/&quote;/gi,'"');a=a.replace(/&quote;/gi,'"');l=l.replace(/_newline_/gi,"\n");l=l.replace(/newline/gi,"\n");a=a.replace(/_newline_/gi,"\n");a=a.replace(/newline/gi,"\n");var i=HtmlUtils.getAceEditor(c);if(i){var o=l+a+" ";var n=i.getCursorPosition();i.insert(o);if(l.endsWith("\n")){n.row++;n.column=0}else{n.column+=l.length}i.selection.moveTo(n.row,n.column);i.focus();return}if(m.selectionStart||m.selectionStart=="0"){var k=m.scrollTop;m.focus();var j=m.selectionStart;var b=m.selectionEnd;d=m.value.substring(j,b);m.value=m.value.substring(0,j)+l+d+a+m.value.substring(b,m.value.length);if(g){m.selectionStart=j+l.length;m.selectionEnd=j+l.length+d.length}else{m.selectionStart=j+l.length+d.length+a.length;m.selectionEnd=m.selectionStart-a.length}m.scrollTop=k;return}if(document.selection&&document.selection.createRange){if(document.documentElement&&document.documentElement.scrollTop){var f=document.documentElement.scrollTop}else{if(document.body){var f=document.body.scrollTop}}m.focus();var h=document.selection.createRange();d=h.text;h.text=l+d+a;if(g&&h.moveStart){if(window.opera){a=a.replace(/\n/g,"")}h.moveStart("character",-a.length-d.length);h.moveEnd("character",-a.length)}if(h.select){h.select()}if(document.documentElement&&document.documentElement.scrollTop){document.documentElement.scrollTop=f}else{if(document.body){document.body.scrollTop=f}}}};