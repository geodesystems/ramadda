function insertText(id,value){hidePopupObject();var handler=getHandler(id);if(handler){handler.insertText(value);return;}
var editor=HtmlUtils.getAceEditor(id);var textComp=GuiUtils.getDomObject(id);if(textComp||editor){insertAtCursor(id,textComp.obj,value);}}
function insertAtCursor(id,myField,value){var editor=HtmlUtils.getAceEditor(id);if(editor){var cursor=editor.getCursorPosition();editor.insert(value);editor.focus();return;}
var textScroll=myField.scrollTop;if(document.selection){myField.focus();sel=document.selection.createRange();sel.text=value;}
else if(myField.selectionStart||myField.selectionStart=='0'){var startPos=myField.selectionStart;var endPos=myField.selectionEnd;myField.value=myField.value.substring(0,startPos)+
value+
myField.value.substring(endPos,myField.value.length);}else{myField.value+=value;}
myField.scrollTop=textScroll;}
function insertTags(id,tagOpen,tagClose,sampleText){hidePopupObject();var handler=getHandler(id);if(handler){handler.insertTags(tagOpen,tagClose,sampleText);return;}
var textComp=GuiUtils.getDomObject(id);var editor=HtmlUtils.getAceEditor(id);if(textComp||editor){insertTagsInner(id,textComp.obj,tagOpen,tagClose,sampleText);}}
function insertTagsInner(id,txtarea,tagOpen,tagClose,sampleText){var selText,isSample=false;tagOpen=tagOpen.replace(/&quote;/gi,'\"');tagClose=tagClose.replace(/&quote;/gi,'\"');tagOpen=tagOpen.replace(/_newline_/gi,'\n');tagOpen=tagOpen.replace(/newline/gi,'\n');tagClose=tagClose.replace(/_newline_/gi,'\n');tagClose=tagClose.replace(/newline/gi,'\n');var editor=HtmlUtils.getAceEditor(id);if(editor){var text=tagOpen+tagClose+" ";var cursor=editor.getCursorPosition();editor.insert(text);if(tagOpen.endsWith("\n")){cursor.row++;cursor.column=0;}else{cursor.column+=tagOpen.length;}
editor.selection.moveTo(cursor.row,cursor.column);editor.focus();return;}
if(txtarea.selectionStart||txtarea.selectionStart=='0'){var textScroll=txtarea.scrollTop;txtarea.focus();var startPos=txtarea.selectionStart;var endPos=txtarea.selectionEnd;selText=txtarea.value.substring(startPos,endPos);txtarea.value=txtarea.value.substring(0,startPos)+
tagOpen+selText+tagClose+
txtarea.value.substring(endPos,txtarea.value.length);if(isSample){txtarea.selectionStart=startPos+tagOpen.length;txtarea.selectionEnd=startPos+tagOpen.length+selText.length;}else{txtarea.selectionStart=startPos+tagOpen.length+selText.length+tagClose.length;txtarea.selectionEnd=txtarea.selectionStart-tagClose.length;}
txtarea.scrollTop=textScroll;return;}
if(document.selection&&document.selection.createRange){if(document.documentElement&&document.documentElement.scrollTop)
var winScroll=document.documentElement.scrollTop
else if(document.body)
var winScroll=document.body.scrollTop;txtarea.focus();var range=document.selection.createRange();selText=range.text;range.text=tagOpen+selText+tagClose;if(isSample&&range.moveStart){if(window.opera)
tagClose=tagClose.replace(/\n/g,'');range.moveStart('character',-tagClose.length-selText.length);range.moveEnd('character',-tagClose.length);}
if(range.select){range.select();}
if(document.documentElement&&document.documentElement.scrollTop)
document.documentElement.scrollTop=winScroll
else if(document.body)
document.body.scrollTop=winScroll;}}
