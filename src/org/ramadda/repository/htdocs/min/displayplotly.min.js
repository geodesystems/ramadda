var CATEGORY_PLOTLY="More Charts";var DISPLAY_PLOTLY_RADAR="radar";var DISPLAY_PLOTLY_WINDROSE="windrose";var DISPLAY_PLOTLY_DENSITY="density";var DISPLAY_PLOTLY_DOTPLOT="dotplot";var DISPLAY_PLOTLY_SPLOM="splom";var DISPLAY_PLOTLY_3DSCATTER="3dscatter";var DISPLAY_PLOTLY_3DMESH="3dmesh";var DISPLAY_PLOTLY_TREEMAP="treemap";var DISPLAY_PLOTLY_TERNARY="ternary";addGlobalDisplayType({type:DISPLAY_PLOTLY_RADAR,label:"Radar",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_WINDROSE,label:"Wind Rose",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_DENSITY,label:"Density",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_DOTPLOT,label:"Dot Plot",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_SPLOM,label:"Splom",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_3DSCATTER,label:"3D Scatter",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});addGlobalDisplayType({type:DISPLAY_PLOTLY_3DMESH,label:"3D Mesh",requiresData:true,forUser:true,category:CATEGORY_PLOTLY});function RamaddaPlotlyDisplay(e,d,c,b){var a;RamaddaUtil.inherit(this,a=new RamaddaFieldsDisplay(e,d,c,b));RamaddaUtil.defineMembers(this,{needsData:function(){return true},setDimensions:function(g,h){var f=parseInt(this.getProperty("height","400").replace("px","").replace("%",""));g.height=f},pointDataLoaded:function(f,g,h){a.pointDataLoaded.call(this,f,g,h);if(this.dataCollection){this.displayManager.propagateEventRecordSelection(this,this.dataCollection.getList()[0],{index:0})}},displayData:function(){this.updateUI()},pageHasLoaded:function(){a.pageHasLoaded.call(this);this.updateUI()},fieldSelectionChanged:function(){a.fieldSelectionChanged.call(this);this.updateUI()},makeAxis:function(g,f){return{title:g,titlefont:{size:20},tickangle:f,tickfont:{size:15},tickcolor:"rgba(0,0,0,0)",ticklen:5,showline:true,showgrid:true}},getDisplayStyle:function(){return""},makePlot:function(g,f){this.clearHtml();this.jq(ID_DISPLAY_CONTENTS).html(HtmlUtil.div(["id",this.getDomId("tmp"),"style",this.getDisplayStyle()],""));var j=Plotly.plot(this.getDomId("tmp"),g,f);var h=document.getElementById(this.getDomId("tmp"));this.addEvents(j,h)},addEvents:function(g,f){}})}function RamaddaRadialDisplay(e,d,c,b){var a;$.extend(this,{width:"400px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(e,d,c,b));RamaddaUtil.defineMembers(this,{getPlotType:function(){return"barpolar"},updateUI:function(){var g=this.filterData();if(!g){return}var m=this.getSelectedFields(this.getData().getRecordFields());var q=this.getFieldOfType(m,"string");if(!q){this.displayError("No string field specified");return}var r=this.getFieldsOfType(m,"numeric");if(r.length==0){this.displayError("No numeric fields specified");return}var f=this.getColumnValues(g,q).values;var p=[];var k=Number.MAX_VALUE;var n=Number.MIN_VALUE;var j=[];for(var l=0;l<r.length;l++){var o=r[l];var h=this.getColumnValues(g,o);k=Math.min(k,h.min);n=Math.max(n,h.max);j.push({type:this.getPlotType(),r:h.values,theta:f,fill:"toself",name:o.getLabel()})}layout={polar:{radialaxis:{visible:true,range:[k,n]}}};this.setDimensions(layout,2);this.makePlot(j,layout)}})}function RamaddaRadarDisplay(d,c,b){var a;RamaddaUtil.inherit(this,a=new RamaddaRadialDisplay(d,c,DISPLAY_PLOTLY_RADAR,b));RamaddaUtil.defineMembers(this,{getPlotType:function(){return"scatterpolar"}});addRamaddaDisplay(this)}function RamaddaWindroseDisplay(d,c,b){var a;RamaddaUtil.inherit(this,a=new RamaddaRadialDisplay(d,c,DISPLAY_PLOTLY_WINDROSE,b));RamaddaUtil.defineMembers(this,{getPlotType:function(){return"barpolar"}});addRamaddaDisplay(this)}function RamaddaDensityDisplay(d,c,b){var a;$.extend(this,{width:"600px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(d,c,DISPLAY_PLOTLY_DENSITY,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{updateUI:function(){var e=this.filterData();if(!e){return}var j=this.getSelectedFields(this.getData().getRecordFields());var n=this.getFieldsOfType(j,"numeric");if(n.length<2){this.displayError("No numeric fields specified");return}var l=this.getColumnValues(e,n[0]);var k=this.getColumnValues(e,n[1]);var g={x:l.values,y:k.values,mode:"markers",name:"",marker:{color:this.getProperty("pointColor","rgb(102,0,0)"),size:parseInt(this.getProperty("markerSize","4")),opacity:0.4},type:"scatter"};var m={x:l.values,y:k.values,name:"density",ncontours:20,colorscale:"Hot",reversescale:true,type:"histogram2dcontour"};var f=[];if(this.getProperty("showDensity",true)){f.push(m)}if(this.getProperty("showPoints",true)){f.push(g)}var h={showlegend:true,autosize:true,margin:{t:50},hovermode:"closest",bargap:0,xaxis:{domain:[l.min,l.max],showline:this.getProperty("showLines",true),showgrid:this.getProperty("showLines",true),title:j[0].getLabel()},yaxis:{domain:[k.min,k.max],showline:this.getProperty("showLines",true),showgrid:this.getProperty("showLines",true),title:j[1].getLabel()}};this.setDimensions(h,2);this.makePlot(f,h)}})}function RamaddaPlotly3DDisplay(e,d,c,b){var a;$.extend(this,{width:"400px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(e,d,c,b));RamaddaUtil.defineMembers(this,{addEvents:function(g,f){f.on("plotly_click",function(){})},getDisplayStyle:function(){return"border: 1px #ccc solid;"},get3DType:function(){return"scatter3d"},updateUI:function(){var f=this.filterData();if(!f){return}var j=this.getSelectedFields(this.getData().getRecordFields());var o=this.getFieldOfType(j,"string");var j=this.getFieldsOfType(j,"numeric");if(j.length==0){this.displayError("No numeric fields specified");return}if(j.length<3){this.displayError("Don't have 3 numeric fields specified");return}var n=this.getColumnValues(f,j[0]);var m=this.getColumnValues(f,j[1]);var l=this.getColumnValues(f,j[2]);var k={x:n.values,y:m.values,z:l.values,mode:"markers",marker:{size:12,line:{color:"rgba(217, 217, 217, 0.14)",width:0.5},opacity:0.8},type:this.get3DType()};var g=[k];var h={scene:{xaxis:{backgroundcolor:"rgb(200, 200, 230)",gridcolor:"rgb(255, 255, 255)",showbackground:true,zerolinecolor:"rgb(255, 255, 255)",title:j[0].getLabel()},yaxis:{backgroundcolor:"rgb(230, 200,230)",gridcolor:"rgb(255, 255, 255)",showbackground:true,zerolinecolor:"rgb(255, 255, 255)",title:j[1].getLabel()},zaxis:{backgroundcolor:"rgb(230, 230,200)",gridcolor:"rgb(255, 255, 255)",showbackground:true,zerolinecolor:"rgb(255, 255, 255)",title:j[2].getLabel()}},margin:{l:0,r:0,b:50,t:50,pad:4}};this.setDimensions(h,2);this.makePlot(g,h)}})}function Ramadda3dmeshDisplay(d,c,b){var a;$.extend(this,{width:"100%",height:"100%"});RamaddaUtil.inherit(this,a=new RamaddaPlotly3DDisplay(d,c,DISPLAY_PLOTLY_3DMESH,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{get3DType:function(){return"mesh3d"}})}function Ramadda3dscatterDisplay(d,c,b){var a;$.extend(this,{width:"100%",height:"100%"});RamaddaUtil.inherit(this,a=new RamaddaPlotly3DDisplay(d,c,DISPLAY_PLOTLY_3DSCATTER,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{get3DType:function(){return"scatter3d"}})}function RamaddaTernaryDisplay(d,c,b){var a;$.extend(this,{width:"400px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(d,c,DISPLAY_PLOTLY_TERNARY,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{updateUI:function(){var f=this.filterData();if(!f){return}var l=this.getSelectedFields(this.getData().getRecordFields());var p=this.getFieldOfType(l,"string");var l=this.getFieldsOfType(l,"numeric");if(l.length==0){this.displayError("No numeric fields specified");return}if(l.length<3){this.displayError("Don't have 3 numeric fields specified");return}var e=[];var o=this.getColumnValues(f,l[0]);var n=this.getColumnValues(f,l[1]);var m=this.getColumnValues(f,l[2]);for(var j=0;j<o.length;j++){e.push({a:100*o[j]/o.max,b:100*n[j]/n.max,c:100*m[j]/m.max,label:p?p.getLabel():"Point "+(j+1)})}var h=[{a:75,b:25,c:0,label:"point 1"},{a:70,b:10,c:20,label:"point 2"},{a:75,b:20,c:5,label:"point 3"},{a:5,b:60,c:35,label:"point 4"},{a:10,b:80,c:10,label:"point 5"},{a:10,b:90,c:0,label:"point 6"},{a:20,b:70,c:10,label:"point 7"},{a:10,b:20,c:70,label:"point 8"},{a:15,b:5,c:80,label:"point 9"},{a:10,b:10,c:80,label:"point 10"},{a:20,b:10,c:70,label:"point 11"}];var g=[{type:"scatterternary",mode:"markers",a:e.map(function(q){return q.a}),b:e.map(function(q){return q.b}),c:e.map(function(q){return q.c}),text:e.map(function(q){return q.label}),marker:{symbol:100,color:"#DB7365",size:14,line:{width:2}}}];var k={ternary:{sum:100,aaxis:this.makeAxis(l[0].getLabel(),0),baxis:this.makeAxis(l[1].getLabel(),45),caxis:this.makeAxis(l[2].getLabel(),-45),bgcolor:"#fff1e0"},annotations:[{showarrow:false,text:this.getProperty("chartTitle",""),x:1,y:1.3,font:{size:15}}],paper_bgcolor:"#fff1e0"};this.setDimensions(k,2);this.makePlot(g,k)}})}function RamaddaDotplotDisplay(d,c,b){var a;$.extend(this,{width:"600px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(d,c,DISPLAY_PLOTLY_DOTPLOT,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{getDisplayStyle:function(){return"border: 1px #ccc solid;"},updateUI:function(){var f=this.filterData();if(!f){return}var o=this.getSelectedFields(this.getData().getRecordFields());var r=this.getFieldOfType(o,"string");var o=this.getFieldsOfType(o,"numeric");if(o.length==0){this.displayError("No numeric fields specified");return}var n=null;var l="";if(r){n=this.getColumnValues(f,r).values;l=r.getLabel()}var e=["rgba(156, 165, 196, 0.95)","rgba(204,204,204,0.95)","rgba(255,255,255,0.85)","rgba(150,150,150,0.95)"];var g=[];for(i in o){var h=i>=e.length?e[0]:e[i];var p=o[i];var q=this.getColumnValues(f,p).values;if(!n){n=[];for(var k=0;k<q.length;k++){n.push("Point "+(k+1))}}g.push({type:"scatter",x:q,y:n,mode:"markers",name:p.getLabel(),marker:{color:h,line:{color:"rgba(156, 165, 196, 1.0)",width:1},symbol:"circle",size:16}})}var m={title:"",yaxis:{title:this.getProperty("yAxisTitle",l),showline:this.getProperty("yAxisShowLine",true),showgrid:this.getProperty("yAxisShowGrid",true)},xaxis:{title:this.getProperty("xAxisTitle",o[i].getLabel()),showgrid:this.getProperty("xAxisShowGrid",false),showline:this.getProperty("xAxisShowLine",true),linecolor:"rgb(102, 102, 102)",titlefont:{font:{color:"rgb(204, 204, 204)"}},tickfont:{font:{color:"rgb(102, 102, 102)"}},autotick:true,ticks:"outside",tickcolor:"rgb(102, 102, 102)"},margin:{l:this.getProperty("marginLeft",140),r:this.getProperty("marginRight",40),b:this.getProperty("marginBottom",50),t:this.getProperty("marginTop",20)},legend:{font:{size:10},yanchor:"middle",xanchor:"right"},paper_bgcolor:"rgb(254, 247, 234)",plot_bgcolor:"rgb(254, 247, 234)",hovermode:"closest"};this.setDimensions(m,2);this.makePlot(g,m)}})}function RamaddaSplomDisplay(d,c,b){var a;$.extend(this,{width:"600px",height:"600px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(d,c,DISPLAY_PLOTLY_SPLOM,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{setDimensions:function(g,h){var f=parseInt(this.getProperty("width","400").replace("px","").replace("%",""));var e=parseInt(this.getProperty("height","400").replace("px","").replace("%",""));g.width=f-h;g.height=e},makeAxis:function(){return{showline:false,zeroline:false,gridcolor:this.getProperty("gridColor","white"),ticklen:2,tickfont:{size:this.getProperty("tickFontSize",12)},titlefont:{size:this.getProperty("titleFontSize",12)}}},updateUI:function(){var C=this.filterData();if(!C){return}var u=this.getSelectedFields(this.getData().getRecordFields());if(u.length==0){u=this.getData().getRecordFields()}var F;if(this.getProperty("labels")){F=this.getProperty("labels").split(",")}var y={type:"splom",dimensions:[],marker:{size:parseInt(this.getProperty("markerSize",5)),line:{color:this.getProperty("lineColor","white"),width:0.5}}};var j=this.getFieldById(u,this.getProperty("colorBy"));var D=this.getProperty("colorBy");if(D){var j=this.getFieldById(u,D);if(j){var p=this.getColumnValues(C,j);var o=this.getColorTable();if(!o){o=Utils.getColorTable("blue_white_red")}var t=[];var x=parseFloat(this.getProperty("colorByMin",p.min));var A=parseFloat(this.getProperty("colorByMax",p.max));if(Utils.isDefined(o.min)){var m=[];for(var B=0;B<o.colors.length;B++){var e=B/o.colors.length;var v=o.min+(o.max-o.min)*e;if(v>=x&&v<=A){m.push(o.colors[B])}}o=m}if(o.colors){o=o.colors}var q=A-x;var f=[];for(var B=0;B<p.values.length;B++){var v=p.values[B];var e=(v-x)/q;f.push(e)}for(var B=0;B<o.length;B++){var v=B/o.length;var s=(B+1)/o.length;t.push([v,o[B]]);t.push([s,o[B]])}y.marker.color=f;y.marker.colorscale=t}this.displayColorTable(o,ID_DISPLAY_BOTTOM,x,A)}var r=this.getFieldOfType(u,"string");if(r){var w=this.getColumnValues(C,r).values;y.text=[];for(var B=0;B<w.length;B++){y.text.push(r.getLabel()+": "+w[B])}}var k=[y];var E={autosize:false,hovermode:"closest",dragmode:"select",plot_bgcolor:this.getProperty("bgColor","rgba(240,240,240, 0.95)"),margin:{l:this.getProperty("marginLeft",140),r:this.getProperty("marginRight",40),b:this.getProperty("marginBottom",50),t:this.getProperty("marginTop",20)}};var z=0;for(var B=0;B<u.length;B++){var g=u[B];if(!g.isFieldNumeric()){continue}var h=this.getColumnValues(C,g).values;var n;if(F&&B<F.length){n=F[B]}else{n=g.getUnitLabel()}y.dimensions.push({label:n,values:h});var G="axis"+(z==0?"":""+(z+1));E["x"+G]=this.makeAxis();E["y"+G]=this.makeAxis();z++}this.setDimensions(E,2);this.makePlot(k,E)}})}function RamaddaTreemapDisplay(d,c,b){var a;$.extend(this,{width:"400px",height:"400px"});RamaddaUtil.inherit(this,a=new RamaddaPlotlyDisplay(d,c,DISPLAY_PLOTLY_TREEMAP,b));addRamaddaDisplay(this);RamaddaUtil.defineMembers(this,{updateUI:function(){var u=this.filterData();if(!u){return}var p=this.getSelectedFields(this.getData().getRecordFields());var f=this.getFieldOfType(p,"numeric");if(!f){this.displayError("No numeric field specified");return}var h=this.getColumnValues(u,f).data;var s=[];var e=[];var n=0;var j=[];var r=[];var q=[];var o=this.getColorTable();if(o.colors){o=o.colors}var m=Treemap.generate(h,100,100);for(var t in m){var g={type:"rect",x0:m[t][0],y0:m[t][1],x1:m[t][2],y1:m[t][3],line:{width:2},fillcolor:o[n]};s.push(g);var l={x:(m[t][0]+m[t][2])/2,y:(m[t][1]+m[t][3])/2,text:String(h[n]),showarrow:false};e.push(l);j.push((m[t][0]+m[t][2])/2);r.push((m[t][1]+m[t][3])/2);q.push(String(h[n]));n++}var k={x:j,y:r,text:q,mode:"text",type:"scatter"};var v={height:700,width:700,shapes:s,hovermode:"closest",annotations:e,xaxis:{showgrid:false,zeroline:false},yaxis:{showgrid:false,zeroline:false}};var w={data:[k]};this.setDimensions(v,2);this.makePlot([k],v)}})};