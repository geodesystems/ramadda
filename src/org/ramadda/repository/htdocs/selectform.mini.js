function SelectForm(e,b,a,d,c){this.id=e;this.entryId=b;this.arg=a;this.outputDivPrefix=d;this.selectValues=c;this.totalSize=0;this.checkboxPrefix="entry_"+this.id+"_";if(!this.arg){this.arg="select"}this.clearSelect=function(f){for(var g=f;g<10;g++){select=this.getSelect(g);if(select.size()==0){break}select.html("<select><option value=''>--</option></select>")}};this.valueDefined=function(f){if(f!=""&&f.indexOf("--")!=0){return true}return false};this.getUrl=function(h){var g=ramaddaBaseUrl+"/entry/show?entryid="+this.entryId;var j=this;var f=$("#"+this.id+" :input");f.each(function(){var k=$(this).val();if(this.name=="entryselect"){if(!$(this).is(":checked")){return}}if(this.type=="radio"){if(!$(this).is(":checked")){return}}if(j.valueDefined(k)){g+="&"+this.name+"="+encodeURIComponent(k)}});if(h!=null){g+="&request="+h}return g};this.bulkdownload=function(g){var f=this.getUrl("bulkdownload");g.preventDefault();window.location.href=f};this.download=function(g){var f=this.getUrl("download");g.preventDefault();window.location.href=f};this.makeKMZ=function(g){var f=this.getUrl("kmz");g.preventDefault();window.location.href=f};this.threddscatalog=function(g){var f=this.getUrl("threddscatalog");g.preventDefault();window.location.href=f};this.makeTimeSeries=function(h){var f="";var g=this.getUrl("timeseries");var j=this;$("#"+this.outputDivPrefix+"image").html('<img alt="Generating Image...." src="'+g+'">');return false};this.search=function(h){var f="";var g=this.getUrl("search");var j=this;$("#"+this.outputDivPrefix+"list").html("<img src="+icon_progress+"> Searching...");$("#"+this.outputDivPrefix+"image").html("");j.totalSize=0;$.getJSON(g,function(k){j.processEntryJson(k)});return false};this.makeImage=function(h){var f="";var g=this.getUrl("image");var j=this;$("#"+this.outputDivPrefix+"image").html('<img alt="Generating Image...." src="'+g+'">');return false};this.processEntryJson=function(z){var o=0;var l="";if(z.length==0){l="Nothing found"}else{var s="40%";var y=0;var f="";var t="";var q="";var h=null;var v=true;var m=createEntriesFromJson(z);for(var u=0;u<m.length;u++){var g=m[u];if(u==0){h=g.getAttributeNames();y=Math.floor(60/(h.length+1))+"%";var x=g.getAttributeLabels();for(var n=0;n<x.length;n++){t+="<td width="+y+"><b>"+x[n]+"</b></td>";q+="<td></td>"}}if(v){f+="<tr class=listrow1>"}else{f+="<tr class=listrow2>"}v=!v;f+="<td width="+s+' ><input name="entryselect" type=checkbox checked value="'+g.getId()+'" id="'+this.checkboxPrefix+ +g.getId()+'" >';f+="&nbsp;&nbsp;"+g.getLink(g.getIconImage()+" "+g.getName());for(var n=0;n<h.length;n++){var r=g.getAttributeValue(h[n]);f+="<td width="+y+">"+r+"</td>"}f+="</td><td align=right width=10%>";f+=g.getFormattedFilesize();o+=g.getFilesize();f+="</tr>"}var j='<table width=100% cellpadding=3 cellspacing=3 id="listing" class="entry-listing" >';l+="<div>";l+=j;l+='<thead><tr style="background: #FFF;">';l+="<td width="+s+">";var k=this.id+"_listcbx";l+='<input type=checkbox checked value=true id="'+k+'"> ';l+="<b>"+z.length+" files found</b></td>"+t+"<td width="+y+" align=right><b>Size</b></td></tr></thead>";l+="</table>";l+="</div>";l+='<div style=" margin-bottom:2px;  margin-top:2px; max-height: 250px; overflow-y: auto; border: 1px #ccc solid;">';l+=j;l+=f;l+="</table>";l+="</div>";l+="<div>";l+=j;l+='<thead><tr style="background: #Fff;">';l+="<td width="+s+">";l+="</td>"+t+"<td width="+y+" align=right><b>"+GuiUtils.size_format(o)+"</b></td></tr></thead>";l+="</table>";l+="</div>"}this.totalSize=o;$("#"+this.outputDivPrefix+"list").html(l);var w=this;var p=$("#"+k);this.getEntryCheckboxes().change(function(A){w.listUpdated()});p.change(function(A){var B=p.is(":checked");w.getEntryCheckboxes().attr("checked",B);w.listUpdated()});this.listUpdated()};this.getEntryCheckboxes=function(){return $(':input[id*="'+this.checkboxPrefix+'"]')};this.listUpdated=function(){var h=this.getEntryCheckboxes();var f=false;h.each(function(j){if($(this).attr("checked")){f=true}});var g=$(':input[id*="'+this.id+'_do_"]');if(f){g.show()}else{g.hide()}};this.isSelectLinked=function(){return false};this.select=function(g){if(!this.isSelectLinked()){return}this.narrowSelect();return;g=parseInt(g);select=this.getSelect(g);if(select.val()==""||select.val().indexOf("--")==0){this.clearSelect(g+1);return false}var h=g+1;var f=this.getUrl("metadata");this.applyToSelect(f,h);return false};this.narrowSelect=function(){var g="";for(var h=0;h<10;h++){select=this.getSelect(h);if(select.size()==0){break}var j=select.val();if(this.valueDefined(j)){g+="&"+this.arg+h+"="+encodeURIComponent(j)}}var f=this.getUrl("metadata");for(var h=0;h<10;h++){select=this.getSelect(h);if(select.size()==0){break}var j=select.val();if(!this.valueDefined(j)){this.applyToSelect(f+"&field="+this.arg+h,h)}}};this.applyToSelect=function(g,f){var h=this;$.getJSON(g,function(p){if(!p.values){alert("error");return}var k="<select>";for(i=0;i<p.values.length;i++){var o=p.values[i];var j=o;var n=o.indexOf(":");if(n>=0){j=o.substring(n+1);o=o.substring(0,n)}if(o.indexOf("--")==0){o=""}k+="<option value='"+o+"'>"+j+"</option>"}k+="</select>";var m=h.getSelect(f);var l=m.val();m.html(k);m.focus();if(l){m.val(l)}h.clearSelect(f+1)})};this.getSelect=function(f){return $("#"+this.id+"_"+this.arg+f)};this.submit=function(){var f=$("#"+this.id+"_value");var g=$("#"+this.id+"_image");g.attr("src",ramaddaBaseUrl+"/icons/"+f.val());return false};this.listUpdated()};