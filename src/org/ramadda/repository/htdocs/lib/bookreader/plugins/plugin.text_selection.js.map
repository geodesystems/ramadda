{"version":3,"file":"plugins/plugin.text_selection.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./src/BookReader/utils/SelectionObserver.js","webpack://@internetarchive/bookreader/./src/util/strings.js","webpack://@internetarchive/bookreader/./src/plugins/plugin.text_selection.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js"],"sourcesContent":["// @ts-check\nexport class SelectionObserver {\n  selecting = false;\n  startedInSelector = false;\n  /** @type {HTMLElement} */\n  target = null;\n\n  /**\n   * @param {string} selector\n   * @param {function('started' | 'cleared', HTMLElement): any} handler\n   */\n  constructor(selector, handler) {\n    this.selector = selector;\n    this.handler = handler;\n  }\n\n  attach() {\n    // We can't just use selectstart, because safari on iOS just\n    // randomly decides when to fire it 😤\n    // document.addEventListener(\"selectstart\", this._onSelectStart);\n    // This has to be on document :/\n    document.addEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  detach() {\n    document.removeEventListener(\"selectionchange\", this._onSelectionChange);\n  }\n\n  _onSelectionChange = () => {\n    const sel = window.getSelection();\n\n    if (!this.selecting && sel.toString()) {\n      const target = $(sel.anchorNode).closest(this.selector)[0];\n      if (!target) return;\n      this.target = target;\n      this.selecting = true;\n      this.handler('started', this.target);\n    }\n\n    if (this.selecting && (sel.isCollapsed || !sel.toString() || !$(sel.anchorNode).closest(this.selector)[0])) {\n      this.selecting = false;\n      this.handler('cleared', this.target);\n    }\n  };\n}\n","/**\n * @typedef {String} StringWithVars\n * A template string with {{foo}} style variables\n * Also supports filters, like {{bookPath|urlencode}} (See APPLY_FILTERS for the\n * supported list of filters)\n **/\n\n/**\n * @param {StringWithVars|String} template\n * @param { {[varName: string]: { toString: () => string} } } vars\n * @param { {[varName: string]: { toString: () => string} } } [overrides]\n */\nexport function applyVariables(template, vars, overrides = {}, possibleFilters = APPLY_FILTERS) {\n  return template?.replace(/\\{\\{([^}]*?)\\}\\}/g, ($0, $1) => {\n    if (!$1) return $0;\n    /** @type {string} */\n    const expression = $1;\n    const [varName, ...filterNames] = expression.split('|').map(x => x.trim());\n    const defined = varName in overrides || varName in vars;\n\n    // If it's not defined, don't expand it at all\n    if (!defined) return $0;\n\n    const value = varName in overrides ? overrides[varName]\n      : varName in vars ? vars[varName] : null;\n    const filters = filterNames.map(n => possibleFilters[n]);\n    return filters.reduce((acc, cur) => cur(acc), value && value.toString());\n  });\n}\n\n/** @type { {[filterName: String]:( string => string)} } */\nexport const APPLY_FILTERS = {\n  urlencode: encodeURIComponent,\n};\n","//@ts-check\nimport { createDIVPageLayer } from '../BookReader/PageContainer.js';\nimport { SelectionObserver } from '../BookReader/utils/SelectionObserver.js';\nimport { applyVariables } from '../util/strings.js';\n/** @typedef {import('../util/strings.js').StringWithVars} StringWithVars */\n/** @typedef {import('../BookReader/PageContainer.js').PageContainer} PageContainer */\n\nconst BookReader = /** @type {typeof import('../BookReader').default} */(window.BookReader);\n\nexport const DEFAULT_OPTIONS = {\n  enabled: true,\n  /** @type {StringWithVars} The URL to fetch the entire DJVU xml. Supports options.vars */\n  fullDjvuXmlUrl: null,\n  /** @type {StringWithVars} The URL to fetch a single page of the DJVU xml. Supports options.vars. Also has {{pageIndex}} */\n  singlePageDjvuXmlUrl: null,\n  /** Whether to fetch the XML as a jsonp */\n  jsonp: false,\n};\n/** @typedef {typeof DEFAULT_OPTIONS} TextSelectionPluginOptions */\n\n/**\n * @template T\n */\nexport class Cache {\n  constructor(maxSize = 10) {\n    this.maxSize = maxSize;\n    /** @type {T[]} */\n    this.entries = [];\n  }\n\n  /**\n   * @param {T} entry\n   */\n  add(entry) {\n    if (this.entries.length >= this.maxSize) {\n      this.entries.shift();\n    }\n    this.entries.push(entry);\n  }\n}\n\nexport class TextSelectionPlugin {\n  /**\n   * @param {'lr' | 'rl'} pageProgression In the future this should be in the ocr file\n   * since a book being right to left doesn't mean the ocr is right to left. But for\n   * now we do make that assumption.\n   */\n  constructor(options = DEFAULT_OPTIONS, optionVariables, pageProgression = 'lr') {\n    this.options = options;\n    this.optionVariables = optionVariables;\n    /**@type {PromiseLike<JQuery<HTMLElement>|undefined>} */\n    this.djvuPagesPromise = null;\n    /** Whether the book is right-to-left */\n    this.rtl = pageProgression === 'rl';\n\n    /** @type {Cache<{index: number, response: any}>} */\n    this.pageTextCache = new Cache();\n\n    /**\n     * Sometimes there are too many words on a page, and the browser becomes near\n     * unusable. For now don't render text layer for pages with too many words.\n     */\n    this.maxWordRendered = 2500;\n\n    this.selectionObserver = new SelectionObserver('.BRtextLayer', this._onSelectionChange);\n  }\n\n  /**\n   * @param {'started' | 'cleared'} type\n   * @param {HTMLElement} target\n   */\n  _onSelectionChange = (type, target) => {\n    if (type === 'started') {\n      this.textSelectingMode(target);\n    } else if (type === 'cleared') {\n      this.defaultMode(target);\n    } else {\n      throw new Error(`Unknown type ${type}`);\n    }\n  }\n\n  init() {\n    this.selectionObserver.attach();\n\n    // Only fetch the full djvu xml if the single page url isn't there\n    if (this.options.singlePageDjvuXmlUrl) return;\n    this.djvuPagesPromise = $.ajax({\n      type: \"GET\",\n      url: applyVariables(this.options.fullDjvuXmlUrl, this.optionVariables),\n      dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n      cache: true,\n      error: (e) => undefined\n    }).then((res) => {\n      try {\n        const xmlMap = $.parseXML(res);\n        return xmlMap && $(xmlMap).find(\"OBJECT\");\n      } catch (e) {\n        return undefined;\n      }\n    });\n  }\n\n  /**\n   * @param {number} index\n   * @returns {Promise<HTMLElement|undefined>}\n   */\n  async getPageText(index) {\n    if (this.options.singlePageDjvuXmlUrl) {\n      const cachedEntry = this.pageTextCache.entries.find(x => x.index == index);\n      if (cachedEntry) {\n        return cachedEntry.response;\n      }\n      const res = await $.ajax({\n        type: \"GET\",\n        url: applyVariables(this.options.singlePageDjvuXmlUrl, this.optionVariables, { pageIndex: index }),\n        dataType: this.options.jsonp ? \"jsonp\" : \"html\",\n        cache: true,\n        error: (e) => undefined,\n      });\n      try {\n        const xmlDoc = $.parseXML(res);\n        const result = xmlDoc && $(xmlDoc).find(\"OBJECT\")[0];\n        this.pageTextCache.add({ index, response: result });\n        return result;\n      } catch (e) {\n        return undefined;\n      }\n    } else {\n      const XMLpagesArr = await this.djvuPagesPromise;\n      if (XMLpagesArr) return XMLpagesArr[index];\n    }\n  }\n\n  /**\n   * Intercept copied text to remove any styling applied to it\n   * @param {JQuery} $container\n   */\n  interceptCopy($container) {\n    $container[0].addEventListener('copy', (event) => {\n      const selection = document.getSelection();\n      event.clipboardData.setData('text/plain', selection.toString());\n      event.preventDefault();\n    });\n  }\n\n  /**\n   * Applies mouse events when in default mode\n   * @param {HTMLElement} textLayer\n   */\n  defaultMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    textLayer.style.pointerEvents = \"none\";\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"auto\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n    const startedMouseDown = this.mouseIsDown;\n    let skipNextMouseup = this.mouseIsDown;\n    if (startedMouseDown) {\n      textLayer.style.pointerEvents = \"auto\";\n    }\n\n    // Need to stop propagation to prevent DragScrollable from\n    // blocking selection\n    $(textLayer).on(\"mousedown.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = true;\n      if ($(event.target).is(\".BRwordElement, .BRspace\")) {\n        event.stopPropagation();\n      }\n    });\n\n    $(textLayer).on(\"mouseup.textSelectPluginHandler\", (event) => {\n      this.mouseIsDown = false;\n      textLayer.style.pointerEvents = \"none\";\n      if (skipNextMouseup) {\n        skipNextMouseup = false;\n        event.stopPropagation();\n      }\n    });\n  }\n\n  /**\n   * This mode is active while there is a selection on the given textLayer\n   * @param {HTMLElement} textLayer\n   */\n  textSelectingMode(textLayer) {\n    const $pageContainer = $(textLayer).closest('.BRpagecontainer');\n    // Make text layer consume all events\n    textLayer.style.pointerEvents = \"all\";\n    // Block img from getting long-press to save while selecting\n    $pageContainer.find(\"img\").css(\"pointer-events\", \"none\");\n\n    $(textLayer).off(\".textSelectPluginHandler\");\n\n    $(textLayer).on('mousedown.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = true;\n      event.stopPropagation();\n    });\n\n    // Prevent page flip on click\n    $(textLayer).on('mouseup.textSelectPluginHandler', (event) => {\n      this.mouseIsDown = false;\n      event.stopPropagation();\n    });\n  }\n\n  /**\n   * Initializes text selection modes if there is a text layer on the page\n   * @param {JQuery} $container\n   */\n  stopPageFlip($container) {\n    /** @type {JQuery<HTMLElement>} */\n    const $textLayer = $container.find('.BRtextLayer');\n    if (!$textLayer.length) return;\n    $textLayer.each((i, s) => this.defaultMode(s));\n    this.interceptCopy($container);\n  }\n\n  /**\n   * @param {PageContainer} pageContainer\n   */\n  async createTextLayer(pageContainer) {\n    const pageIndex = pageContainer.page.index;\n    const $container = pageContainer.$container;\n    const $textLayers = $container.find('.BRtextLayer');\n    if ($textLayers.length) return;\n    const XMLpage = await this.getPageText(pageIndex);\n    if (!XMLpage) return;\n    recursivelyAddCoords(XMLpage);\n\n    const totalWords = $(XMLpage).find(\"WORD\").length;\n    if (totalWords > this.maxWordRendered) {\n      console.log(`Page ${pageIndex} has too many words (${totalWords} > ${this.maxWordRendered}). Not rendering text layer.`);\n      return;\n    }\n\n    const textLayer = createDIVPageLayer(pageContainer.page, 'BRtextLayer');\n    const ratioW = parseFloat(pageContainer.$container[0].style.width) / pageContainer.page.width;\n    const ratioH = parseFloat(pageContainer.$container[0].style.height) / pageContainer.page.height;\n    textLayer.style.transform = `scale(${ratioW}, ${ratioH})`;\n    textLayer.setAttribute(\"dir\", this.rtl ? \"rtl\" : \"ltr\");\n\n    const ocrParagraphs = $(XMLpage).find(\"PARAGRAPH[coords]\").toArray();\n    const paragEls = ocrParagraphs.map(p => {\n      const el = this.renderParagraph(p);\n      textLayer.appendChild(el);\n      return el;\n    });\n\n    // Fix up paragraph positions\n    const paragraphRects = determineRealRects(textLayer, '.BRparagraphElement');\n    let yAdded = 0;\n    for (const [ocrParagraph, paragEl] of zip(ocrParagraphs, paragEls)) {\n      const ocrParagBounds = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n      const realRect = paragraphRects.get(paragEl);\n      const [ocrLeft, , ocrRight, ocrTop] = ocrParagBounds;\n      const newStartMargin = this.rtl ? (realRect.right - ocrRight) : (ocrLeft - realRect.left);\n      const newTop = ocrTop - (realRect.top + yAdded);\n\n      paragEl.style[this.rtl ? 'marginRight' : 'marginLeft'] = `${newStartMargin}px`;\n      paragEl.style.marginTop = `${newTop}px`;\n      yAdded += newTop;\n      textLayer.appendChild(paragEl);\n    }\n    $container.append(textLayer);\n    this.stopPageFlip($container);\n  }\n\n  /**\n   * @param {HTMLElement} ocrParagraph\n   * @returns {HTMLParagraphElement}\n   */\n  renderParagraph(ocrParagraph) {\n    const paragEl = document.createElement('p');\n    paragEl.classList.add('BRparagraphElement');\n    const [paragLeft, paragBottom, paragRight, paragTop] = $(ocrParagraph).attr(\"coords\").split(\",\").map(parseFloat);\n    const wordHeightArr = [];\n    const lines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    if (!lines.length) return paragEl;\n\n\n    for (const [prevLine, line, nextLine] of lookAroundWindow(genMap(lines, augmentLine))) {\n      const isLastLineOfParagraph = line.ocrElement == lines[lines.length - 1];\n      const lineEl = document.createElement('span');\n      lineEl.classList.add('BRlineElement');\n\n      for (const [wordIndex, currWord] of line.words.entries()) {\n        const [, bottom, right, top] = $(currWord).attr(\"coords\").split(',').map(parseFloat);\n        const wordHeight = bottom - top;\n        wordHeightArr.push(wordHeight);\n\n        if (wordIndex == 0 && prevLine?.lastWord.textContent.trim().endsWith('-')) {\n          // ideally prefer the next line to determine the left position,\n          // since the previous line could be the first line of the paragraph\n          // and hence have an incorrectly indented first word.\n          // E.g. https://archive.org/details/driitaleofdaring00bachuoft/page/360/mode/2up\n          const [newLeft, , , ] = $((nextLine || prevLine).firstWord).attr(\"coords\").split(',').map(parseFloat);\n          $(currWord).attr(\"coords\", `${newLeft},${bottom},${right},${top}`);\n        }\n\n        const wordEl = document.createElement('span');\n        wordEl.setAttribute(\"class\", \"BRwordElement\");\n        wordEl.textContent = currWord.textContent.trim();\n\n        if (wordIndex > 0) {\n          const space = document.createElement('span');\n          space.classList.add('BRspace');\n          space.textContent = ' ';\n          lineEl.append(space);\n\n          // Edge ignores empty elements (like BRspace), so add another\n          // space to ensure Edge's ReadAloud works correctly.\n          lineEl.appendChild(document.createTextNode(' '));\n        }\n\n        lineEl.appendChild(wordEl);\n      }\n\n      const hasHyphen = line.lastWord.textContent.trim().endsWith('-');\n      const lastWordEl = lineEl.children[lineEl.children.length - 1];\n      if (hasHyphen && !isLastLineOfParagraph) {\n        lastWordEl.textContent = lastWordEl.textContent.trim().slice(0, -1);\n        lastWordEl.classList.add('BRwordElement--hyphen');\n      }\n\n      paragEl.appendChild(lineEl);\n      if (!isLastLineOfParagraph && !hasHyphen) {\n        // Edge does not correctly have spaces between the lines.\n        paragEl.appendChild(document.createTextNode(' '));\n      }\n    }\n\n    wordHeightArr.sort((a, b) => a - b);\n    const paragWordHeight = wordHeightArr[Math.floor(wordHeightArr.length * 0.85)] + 4;\n    paragEl.style.left = `${paragLeft}px`;\n    paragEl.style.top = `${paragTop}px`;\n    paragEl.style.width = `${paragRight - paragLeft}px`;\n    paragEl.style.height = `${paragBottom - paragTop}px`;\n    paragEl.style.fontSize = `${paragWordHeight}px`;\n\n    // Fix up sizes - stretch/crush words as necessary using letter spacing\n    let wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const ocrWords = $(ocrParagraph).find(\"WORD\").toArray();\n    const wordEls = paragEl.querySelectorAll('.BRwordElement');\n    for (const [ocrWord, wordEl] of zip(ocrWords, wordEls)) {\n      const realRect = wordRects.get(wordEl);\n      const [left, , right ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n      let ocrWidth = right - left;\n      // Some books (eg theworksofplato01platiala) have a space _inside_ the <WORD>\n      // element. That makes it impossible to determine the correct positining\n      // of everything, but to avoid the BRspace's being width 0, which makes selection\n      // janky on Chrome Android, assume the space is the same width as one of the\n      // letters.\n      if (ocrWord.textContent.endsWith(' ')) {\n        ocrWidth = ocrWidth * (ocrWord.textContent.length - 1) / ocrWord.textContent.length;\n      }\n      const diff = ocrWidth - realRect.width;\n      wordEl.style.letterSpacing = `${diff / (ocrWord.textContent.length - 1)}px`;\n    }\n\n    // Stretch/crush lines as necessary using line spacing\n    // Recompute rects after letter spacing\n    wordRects = determineRealRects(paragEl, '.BRwordElement');\n    const spaceRects = determineRealRects(paragEl, '.BRspace');\n\n    const ocrLines = $(ocrParagraph).find(\"LINE[coords]\").toArray();\n    const lineEls = Array.from(paragEl.querySelectorAll('.BRlineElement'));\n\n    let ySoFar = paragTop;\n    for (const [ocrLine, lineEl] of zip(ocrLines, lineEls)) {\n      // shift words using marginLeft to align with the correct x position\n      const words = $(ocrLine).find(\"WORD\").toArray();\n      // const ocrLineLeft = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[0])));\n      let xSoFar = this.rtl ? paragRight : paragLeft;\n      for (const [ocrWord, wordEl] of zip(words, lineEl.querySelectorAll('.BRwordElement'))) {\n        // start of line, need to compute the offset relative to the OCR words\n        const wordRect = wordRects.get(wordEl);\n        const [ocrLeft, , ocrRight ] = $(ocrWord).attr(\"coords\").split(',').map(parseFloat);\n        const diff = (this.rtl ? -(ocrRight - xSoFar) : ocrLeft - xSoFar);\n\n        if (wordEl.previousElementSibling) {\n          const space = wordEl.previousElementSibling;\n          space.style.letterSpacing = `${diff - spaceRects.get(space).width}px`;\n        } else {\n          wordEl.style[this.rtl ? 'paddingRight' : 'paddingLeft'] = `${diff}px`;\n        }\n        if (this.rtl) xSoFar -= diff + wordRect.width;\n        else xSoFar += diff + wordRect.width;\n      }\n      // And also fix y position\n      const ocrLineTop = Math.min(...words.map(w => parseFloat($(w).attr(\"coords\").split(',')[3])));\n      const diff = ocrLineTop - ySoFar;\n      if (lineEl.previousElementSibling) {\n        lineEl.previousElementSibling.style.lineHeight = `${diff}px`;\n        ySoFar += diff;\n      }\n    }\n\n    // The last line will have a line height subtracting from the paragraph height\n    lineEls[lineEls.length - 1].style.lineHeight = `${paragBottom - ySoFar}px`;\n\n    // Edge does not include a newline for some reason when copying/pasting the <p> els\n    paragEl.appendChild(document.createElement('br'));\n    return paragEl;\n  }\n}\n\nexport class BookreaderWithTextSelection extends BookReader {\n  init() {\n    const options = Object.assign({}, DEFAULT_OPTIONS, this.options.plugins.textSelection);\n    if (options.enabled) {\n      this.textSelectionPlugin = new TextSelectionPlugin(options, this.options.vars, this.pageProgression);\n      // Write this back; this way the plugin is the source of truth, and BR just\n      // contains a reference to it.\n      this.options.plugins.textSelection = options;\n      this.textSelectionPlugin.init();\n\n      new SelectionObserver('.BRtextLayer', (selectEvent) => {\n        // Track how often selection is used\n        if (selectEvent == 'started') {\n          this.archiveAnalyticsSendEvent?.('BookReader', 'SelectStart');\n\n          // Set a class on the page to avoid hiding it when zooming/etc\n          this.refs.$br.find('.BRpagecontainer--hasSelection').removeClass('BRpagecontainer--hasSelection');\n          $(window.getSelection().anchorNode).closest('.BRpagecontainer').addClass('BRpagecontainer--hasSelection');\n        }\n      }).attach();\n    }\n\n    super.init();\n  }\n\n  /**\n   * @param {number} index\n   */\n  _createPageContainer(index) {\n    const pageContainer = super._createPageContainer(index);\n    // Disable if thumb mode; it's too janky\n    // .page can be null for \"pre-cover\" region\n    if (this.mode !== this.constModeThumb && pageContainer.page) {\n      this.textSelectionPlugin?.createTextLayer(pageContainer);\n    }\n    return pageContainer;\n  }\n}\nwindow.BookReader = BookreaderWithTextSelection;\nexport default BookreaderWithTextSelection;\n\n\n/**\n * @param {HTMLElement} parentEl\n * @param {string} selector\n * @returns {Map<Element, Rect>}\n */\nfunction determineRealRects(parentEl, selector) {\n  const initals = {\n    position: parentEl.style.position,\n    visibility: parentEl.style.visibility,\n    top: parentEl.style.top,\n    left: parentEl.style.left,\n    transform: parentEl.style.transform,\n  };\n  parentEl.style.position = 'absolute';\n  parentEl.style.visibility = 'hidden';\n  parentEl.style.top = '0';\n  parentEl.style.left = '0';\n  parentEl.style.transform = 'none';\n  document.body.appendChild(parentEl);\n  const rects = new Map(\n    Array.from(parentEl.querySelectorAll(selector))\n      .map(wordEl => {\n        const origRect = wordEl.getBoundingClientRect();\n        return [wordEl, new Rect(\n          origRect.left + window.scrollX,\n          origRect.top + window.scrollY,\n          origRect.width,\n          origRect.height,\n        )];\n      })\n  );\n  document.body.removeChild(parentEl);\n  Object.assign(parentEl.style, initals);\n  return rects;\n}\n\n/**\n * @param {HTMLElement} line\n */\nfunction augmentLine(line) {\n  const words = $(line).find(\"WORD\").toArray();\n  return {\n    ocrElement: line,\n    words,\n    firstWord: words[0],\n    lastWord: words[words.length - 1],\n  };\n}\n\n/**\n * @template TFrom, TTo\n * Generator version of map\n * @param {Iterable<TFrom>} gen\n * @param {function(TFrom): TTo} fn\n * @returns {Iterable<TTo>}\n */\nexport function* genMap(gen, fn) {\n  for (const x of gen) yield fn(x);\n}\n\n/**\n * @template T\n * Generator that provides a sliding window of 3 elements,\n * prev, current, and next.\n * @param {Iterable<T>} gen\n * @returns {Iterable<[T | undefined, T, T | undefined]>}\n */\nexport function* lookAroundWindow(gen) {\n  let prev = undefined;\n  let cur = undefined;\n  let next = undefined;\n  for (const x of gen) {\n    if (typeof cur !== 'undefined') {\n      next = x;\n      yield [prev, cur, next];\n    }\n    prev = cur;\n    cur = x;\n    next = undefined;\n  }\n\n  if (typeof cur !== 'undefined') {\n    yield [prev, cur, next];\n  }\n}\n\n/**\n * @template T1, T2\n * Lazy zip implementation to avoid importing lodash\n * Expects iterators to be of the same length\n * @param {Iterable<T1>} gen1\n * @param {Iterable<T2>} gen2\n * @returns {Iterable<[T1, T2]>}\n */\nexport function* zip(gen1, gen2) {\n  const it1 = gen1[Symbol.iterator]();\n  const it2 = gen2[Symbol.iterator]();\n  while (true) {\n    const r1 = it1.next();\n    const r2 = it2.next();\n    if (r1.done && r2.done) {\n      return;\n    }\n    if (r1.done || r2.done) {\n      throw new Error('zip: one of the iterators is done');\n    }\n    yield [r1.value, r2.value];\n  }\n}\n\n/**\n * [left, bottom, right, top]\n * @param {Array<[number, number, number, number]>} bounds\n * @returns {[number, number, number, number]}\n */\nfunction determineBounds(bounds) {\n  let leftMost = Infinity;\n  let bottomMost = -Infinity;\n  let rightMost = -Infinity;\n  let topMost = Infinity;\n\n  for (const [left, bottom, right, top] of bounds) {\n    leftMost = Math.min(leftMost, left);\n    bottomMost = Math.max(bottomMost, bottom);\n    rightMost = Math.max(rightMost, right);\n    topMost = Math.min(topMost, top);\n  }\n\n  return [leftMost, bottomMost, rightMost, topMost];\n}\n\n/**\n * Recursively traverses the XML tree and adds coords\n * which are the bounding box of all child coords\n * @param {Element} xmlEl\n */\nfunction recursivelyAddCoords(xmlEl) {\n  if ($(xmlEl).attr('coords') || !xmlEl.children) {\n    return;\n  }\n\n  const children = $(xmlEl).children().toArray();\n  if (children.length === 0) {\n    return;\n  }\n\n  for (const child of children) {\n    recursivelyAddCoords(child);\n  }\n\n  const childCoords = [];\n\n  for (const child of children) {\n    if (!$(child).attr('coords')) continue;\n    childCoords.push($(child).attr('coords').split(',').map(parseFloat));\n  }\n\n  const boundingCoords = determineBounds(childCoords);\n  if (Math.abs(boundingCoords[0]) != Infinity) {\n    $(xmlEl).attr('coords', boundingCoords.join(','));\n  }\n}\n\n/**\n * Basically a polyfill for the native DOMRect class\n */\nclass Rect {\n  /**\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   */\n  constructor(x, y, width, height) {\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  get right() { return this.x + this.width; }\n  get bottom() { return this.y + this.height; }\n  get top() { return this.y; }\n  get left() { return this.x; }\n}\n","'use strict';\nvar PROPER_FUNCTION_NAME = require('../internals/function-name').PROPER;\nvar fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]()\n      || non[METHOD_NAME]() !== non\n      || (PROPER_FUNCTION_NAME && whitespaces[METHOD_NAME].name !== METHOD_NAME);\n  });\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n"],"names":["SelectionObserver","selector","handler","_this","_classCallCheck","_defineProperty","sel","window","getSelection","selecting","toString","target","$","anchorNode","closest","isCollapsed","this","key","value","document","addEventListener","_onSelectionChange","removeEventListener","applyVariables","template","vars","overrides","arguments","length","undefined","possibleFilters","APPLY_FILTERS","replace","$0","$1","_expression$split$map2","split","map","x","trim","varName","filterNames","slice","n","reduce","acc","cur","urlencode","encodeURIComponent","genMap","_marked2","_regeneratorRuntime","mark","lookAroundWindow","_marked3","zip","_get","Reflect","get","bind","property","receiver","base","object","Object","prototype","hasOwnProperty","call","_getPrototypeOf","_superPropBase","desc","getOwnPropertyDescriptor","apply","_setPrototypeOf","o","p","setPrototypeOf","__proto__","getPrototypeOf","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","r","l","t","Symbol","iterator","e","u","a","f","next","done","push","return","_iterableToArrayLimit","_unsupportedIterableToArray","TypeError","_nonIterableRest","_createForOfIteratorHelper","allowArrayLike","it","F","s","_e","err","normalCompletion","didErr","step","_e2","minLen","_arrayLikeToArray","constructor","name","from","test","len","arr2","defineProperty","c","asyncIterator","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","y","GeneratorFunction","GeneratorFunctionPrototype","d","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","resultName","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","gen","reject","_next","_throw","info","error","_asyncToGenerator","fn","self","args","instance","Constructor","_defineProperties","props","descriptor","_toPropertyKey","_createClass","protoProps","staticProps","input","hint","prim","toPrimitive","res","String","_toPrimitive","BookReader","DEFAULT_OPTIONS","enabled","fullDjvuXmlUrl","singlePageDjvuXmlUrl","jsonp","Cache","maxSize","entries","entry","shift","TextSelectionPlugin","obj","options","optionVariables","pageProgression","textSelectingMode","concat","defaultMode","djvuPagesPromise","rtl","pageTextCache","maxWordRendered","selectionObserver","_createTextLayer","_getPageText","attach","ajax","url","dataType","cache","xmlMap","parseXML","find","_callee","index","cachedEntry","xmlDoc","result","XMLpagesArr","_context","response","pageIndex","add","t0","_x","$container","event","selection","clipboardData","setData","preventDefault","textLayer","_this2","$pageContainer","style","pointerEvents","css","off","startedMouseDown","mouseIsDown","skipNextMouseup","on","is","stopPropagation","_this3","_this4","$textLayer","each","interceptCopy","_callee2","pageContainer","XMLpage","totalWords","ratioW","ratioH","ocrParagraphs","paragEls","paragraphRects","yAdded","_iterator","_step","_step$value","ocrParagraph","paragEl","ocrParagBounds","realRect","_ocrParagBounds","ocrLeft","ocrRight","ocrTop","newStartMargin","newTop","_this5","_context2","page","getPageText","recursivelyAddCoords","console","log","createDIVPageLayer","parseFloat","width","height","transform","setAttribute","toArray","el","renderParagraph","appendChild","determineRealRects","attr","right","left","top","marginTop","append","stopPageFlip","_x2","createElement","classList","_$$attr$split$map2","paragLeft","paragBottom","paragRight","paragTop","wordHeightArr","lines","_step2","_iterator2","augmentLine","_step2$value","prevLine","line","nextLine","isLastLineOfParagraph","ocrElement","lineEl","_step5","_iterator5","words","_step5$value","wordIndex","currWord","_$$attr$split$map4","bottom","wordHeight","lastWord","textContent","endsWith","newLeft","firstWord","wordEl","space","createTextNode","hasHyphen","lastWordEl","children","sort","b","paragWordHeight","Math","floor","fontSize","_step3","wordRects","_iterator3","querySelectorAll","_step3$value","ocrWord","_$$attr$split$map8","ocrWidth","diff","letterSpacing","_step4","spaceRects","ocrLines","lineEls","ySoFar","_iterator4","_step6","_step4$value","ocrLine","xSoFar","_iterator6","_step6$value","wordRect","_$$attr$split$map10","previousElementSibling","min","_arrayWithoutHoles","w","iter","_iterableToArray","_nonIterableSpread","lineHeight","BookreaderWithTextSelection","_BookReader","subClass","superClass","_inherits","Derived","hasNativeReflectConstruct","_super","construct","sham","Proxy","Boolean","valueOf","_isNativeReflectConstruct","Super","NewTarget","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_this6","assign","plugins","textSelection","textSelectionPlugin","init","selectEvent","_this6$archiveAnalyti","archiveAnalyticsSendEvent","refs","$br","removeClass","addClass","_this$textSelectionPl","mode","constModeThumb","createTextLayer","parentEl","initals","position","visibility","body","rects","Map","origRect","getBoundingClientRect","Rect","scrollX","scrollY","removeChild","_iterator7","_step7","_context3","_marked","_iterator8","_step8","_context4","gen1","gen2","it1","it2","r1","r2","_context5","xmlEl","_step10","_iterator10","_step11","childCoords","_iterator11","child","boundingCoords","bounds","_step9","leftMost","Infinity","bottomMost","rightMost","topMost","_iterator9","_step9$value","max","determineBounds","abs","join","PROPER_FUNCTION_NAME","fails","whitespaces","module","exports","METHOD_NAME","$trim","proto","forced","forcedStringTrimMethod"],"sourceRoot":""}