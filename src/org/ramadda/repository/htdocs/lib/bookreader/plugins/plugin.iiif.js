"use strict";(self.webpackChunk_internetarchive_bookreader=self.webpackChunk_internetarchive_bookreader||[]).push([[623],{121:function(t,e,n){function r(){return r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},r.apply(this,arguments)}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function o(t){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},o(t)}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===a(i)?i:String(i)),r)}var i}function f(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n(886),n(4338),n(228),n(7522),n(9373),n(9903),n(9749),n(6544),n(9288),n(9358),n(429),n(4254),n(752),n(1694),n(6265),n(8052),n(50),n(2349),n(1919);var s=window.BookReader,l={enabled:!0,manifest:null},p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments.length>1?arguments[1]:void 0;u(this,t),this.options=e,this.optionVariables=n,this.manifest=e.manifest}return f(t,[{key:"load",value:function(){if("http://iiif.io/api/presentation/2/context.json"==this.manifest["@context"]){var t=this.manifest;return this.manifestToBookReaderV2(t)}if("http://iiif.io/api/presentation/3/context.json"==this.manifest["@context"]){var e=this.manifest;return this.manifestToBookReaderV3(e)}throw new Error("Unsupported IIIF context "+this.manifest["@context"])}},{key:"manifestToBookReaderV3",value:function(t){var e={bookTitle:h(t.label),pageProgression:"right-to-left"==t.viewingDirection?"rl":"lr",metadata:t.metadata.map((function(t){return{label:h(t.label),value:h(t.value)}})),data:[],getPageURI:function(e,n,r){var i=Math.floor(100/n),o=t.items[e].items[0].items[0].body,a=(o instanceof Array?o[0]:o).service[0].id;return"".concat(a,"/full/pct:").concat(i,"/0/default.jpg")}};"top-to-bottom"!=t.viewingDirection&&"bottom-to-top"!=t.viewingDirection||console.warn("Unsupported viewingDirection",t.viewingDirection);var n=[];return t.items.forEach((function(r,i){var o=t.items[i].items[0].items[0].body,a={uri:(o instanceof Array?o[0]:o).service[0].id,width:r.width,height:r.height,pageNum:h(r.label)};n.push(a),i%2==0&&(e.data.push(n),n=[])})),e}},{key:"manifestToBookReaderV2",value:function(t){var e,n={bookTitle:t.label,metadata:t.metadata,thumbnail:null===(e=t.thumbnail)||void 0===e?void 0:e["@id"],data:[],getPageURI:function(e,n,r){var i=Math.floor(100/n),o=t.sequences[0].canvases[e].images[0].resource.service["@id"];return"".concat(o,"/full/pct:").concat(i,"/0/default.jpg")}},r=[];return t.sequences[0].canvases.forEach((function(t,e){var i={uri:t.images[0].resource.service["@id"],width:t.width,height:t.height,pageNum:t.label};r.push(i),e%2==0&&(n.data.push(r),r=[])})),n}}]),t}();function h(t){var e=Object.keys(t)[0];return(t[navigator.language]||t[e])[0]}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(s,t);var e,n,c=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=o(e);if(n){var i=o(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return function(t,e){if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function s(){return u(this,s),c.apply(this,arguments)}return f(s,[{key:"setup",value:function(t){var e=Object.assign({},l,t.plugins.iiif);return e.enabled&&(this.iiifPlugin=new p(e,t.vars),t.plugins.iiif=this.iiifPlugin.options,Object.assign(t,this.iiifPlugin.load())),r(o(s.prototype),"setup",this).call(this,t)}}]),s}(s);window.BookReader=b}},function(t){t(t.s=121)}]);
//# sourceMappingURL=plugin.iiif.js.map